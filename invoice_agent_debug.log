2025-02-04 19:46:55,728 - __main__ - DEBUG - Python version: 3.12.5 (v3.12.5:ff3bc82f7c9, Aug  7 2024, 05:32:06) [Clang 13.0.0 (clang-1300.0.29.30)]
2025-02-04 19:46:55,728 - __main__ - DEBUG - Python executable: /Users/sailesh/Documents/GitHub/aiagent/venv/bin/python3.12
2025-02-04 19:46:55,728 - __main__ - DEBUG - Current working directory: /Users/sailesh/Documents/GitHub/invoiceAgent
2025-02-04 19:46:55,728 - __main__ - DEBUG - PYTHONPATH: :/Users/sailesh/Documents/GitHub/invoiceAgent/src
2025-02-04 19:46:55,728 - __main__ - DEBUG - Sys.path: ['src/invoice_agent/ui/app.py', 'src/invoice_agent/ui', '/Users/sailesh/Documents/GitHub/aiagent/venv/bin', '/Users/sailesh/Documents/GitHub/invoiceAgent', '/Users/sailesh/Documents/GitHub/invoiceAgent/src', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python312.zip', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/lib-dynload', '/Users/sailesh/Documents/GitHub/aiagent/venv/lib/python3.12/site-packages']
2025-02-04 19:46:55,729 - __main__ - DEBUG - Environment variables loaded
2025-02-04 19:46:55,729 - __main__ - DEBUG - Attempting to import invoice_agent modules...
2025-02-04 19:46:55,730 - __main__ - DEBUG - Importing invoice_agent modules...
2025-02-04 19:46:58,101 - __main__ - DEBUG - Imported InvoiceAgent
2025-02-04 19:46:58,101 - __main__ - DEBUG - Imported config_loader
2025-02-04 19:46:58,102 - __main__ - DEBUG - Imported AuthManager
2025-02-04 19:46:58,102 - __main__ - DEBUG - Imported TemplateManager
2025-02-04 19:46:58,102 - __main__ - DEBUG - Imported WorkflowManager
2025-02-04 19:46:58,102 - __main__ - DEBUG - Imported MetricsManager
2025-02-04 19:46:58,102 - __main__ - DEBUG - Initializing AuthManager...
2025-02-04 19:46:58,102 - __main__ - DEBUG - AuthManager initialized successfully
2025-02-04 19:46:58,102 - __main__ - DEBUG - Initializing MetricsManager...
2025-02-04 19:46:58,102 - __main__ - DEBUG - MetricsManager initialized successfully
2025-02-04 19:46:58,102 - __main__ - DEBUG - Initializing InvoiceAgent...
2025-02-04 19:46:58,105 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): huggingface.co:443
2025-02-04 19:46:58,243 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-02-04 19:46:58,314 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-02-04 19:46:58,439 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/processor_config.json HTTP/1.1" 404 0
2025-02-04 19:46:58,540 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/chat_template.json HTTP/1.1" 404 0
2025-02-04 19:46:58,603 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-02-04 19:46:58,768 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/config.json HTTP/1.1" 200 0
2025-02-04 19:46:58,828 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/config.json HTTP/1.1" 200 0
2025-02-04 19:46:58,922 - __main__ - DEBUG - InvoiceAgent initialized successfully
2025-02-04 19:46:58,922 - __main__ - DEBUG - Initializing WorkflowManager...
2025-02-04 19:46:58,924 - __main__ - DEBUG - WorkflowManager initialized successfully
2025-02-04 19:46:58,924 - __main__ - DEBUG - Initializing TemplateManager...
2025-02-04 19:46:58,924 - __main__ - DEBUG - TemplateManager initialized successfully
2025-02-04 19:46:58,924 - __main__ - DEBUG - Server settings configured
2025-02-04 19:46:58,926 - __main__ - DEBUG - Starting main application
2025-02-04 19:46:58,926 - __main__ - DEBUG - Initial session state: {}
2025-02-04 19:46:58,927 - __main__ - DEBUG - Session state after initialization: {'auth_error': None, 'page': 'Dashboard', 'user_info': None, 'last_activity': 1738716418.926816, 'connection_attempts': 0, 'authenticated': False, 'auth_flow_started': False, 'initialized': True}
2025-02-04 19:46:58,927 - __main__ - DEBUG - Checking for OAuth callback parameters
2025-02-04 19:46:58,927 - __main__ - DEBUG - Query parameters: {}
2025-02-04 19:46:58,927 - __main__ - DEBUG - User not authenticated, showing auth page
2025-02-04 19:46:58,927 - __main__ - DEBUG - Rendering authentication page
2025-02-04 19:46:58,927 - __main__ - DEBUG - Current session state: {'auth_error': None, 'page': 'Dashboard', 'user_info': None, 'last_activity': 1738716418.926816, 'connection_attempts': 0, 'authenticated': False, 'auth_flow_started': False, 'initialized': True}
2025-02-04 19:46:58,928 - __main__ - DEBUG - Showing Google sign-in button
2025-02-04 19:46:58,928 - __main__ - DEBUG - Showing Microsoft sign-in button
2025-02-04 19:46:58,929 - __main__ - DEBUG - Showing Service Account sign-in form
2025-02-04 19:47:01,419 - __main__ - DEBUG - Python version: 3.12.5 (v3.12.5:ff3bc82f7c9, Aug  7 2024, 05:32:06) [Clang 13.0.0 (clang-1300.0.29.30)]
2025-02-04 19:47:01,420 - __main__ - DEBUG - Python executable: /Users/sailesh/Documents/GitHub/aiagent/venv/bin/python3.12
2025-02-04 19:47:01,421 - __main__ - DEBUG - Current working directory: /Users/sailesh/Documents/GitHub/invoiceAgent
2025-02-04 19:47:01,421 - __main__ - DEBUG - PYTHONPATH: :/Users/sailesh/Documents/GitHub/invoiceAgent/src
2025-02-04 19:47:01,421 - __main__ - DEBUG - Sys.path: ['src/invoice_agent/ui/app.py', 'src/invoice_agent/ui', '/Users/sailesh/Documents/GitHub/aiagent/venv/bin', '/Users/sailesh/Documents/GitHub/invoiceAgent', '/Users/sailesh/Documents/GitHub/invoiceAgent/src', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python312.zip', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/lib-dynload', '/Users/sailesh/Documents/GitHub/aiagent/venv/lib/python3.12/site-packages', '/var/folders/0c/vbd1lzvs6p35p66t1zm047sh0000gn/T/tmp7rt26500']
2025-02-04 19:47:01,425 - __main__ - DEBUG - Environment variables loaded
2025-02-04 19:47:01,425 - __main__ - DEBUG - Attempting to import invoice_agent modules...
2025-02-04 19:47:01,425 - __main__ - DEBUG - Importing invoice_agent modules...
2025-02-04 19:47:01,425 - __main__ - DEBUG - Imported InvoiceAgent
2025-02-04 19:47:01,426 - __main__ - DEBUG - Imported config_loader
2025-02-04 19:47:01,426 - __main__ - DEBUG - Imported AuthManager
2025-02-04 19:47:01,426 - __main__ - DEBUG - Imported TemplateManager
2025-02-04 19:47:01,426 - __main__ - DEBUG - Imported WorkflowManager
2025-02-04 19:47:01,426 - __main__ - DEBUG - Imported MetricsManager
2025-02-04 19:47:01,426 - __main__ - DEBUG - Initializing AuthManager...
2025-02-04 19:47:01,426 - __main__ - DEBUG - AuthManager initialized successfully
2025-02-04 19:47:01,426 - __main__ - DEBUG - Initializing MetricsManager...
2025-02-04 19:47:01,426 - __main__ - DEBUG - MetricsManager initialized successfully
2025-02-04 19:47:01,426 - __main__ - DEBUG - Initializing InvoiceAgent...
2025-02-04 19:47:01,547 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-02-04 19:47:01,598 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-02-04 19:47:01,744 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/processor_config.json HTTP/1.1" 404 0
2025-02-04 19:47:01,802 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/chat_template.json HTTP/1.1" 404 0
2025-02-04 19:47:01,865 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-02-04 19:47:02,171 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/config.json HTTP/1.1" 200 0
2025-02-04 19:47:02,226 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/config.json HTTP/1.1" 200 0
2025-02-04 19:47:02,260 - __main__ - DEBUG - InvoiceAgent initialized successfully
2025-02-04 19:47:02,260 - __main__ - DEBUG - Initializing WorkflowManager...
2025-02-04 19:47:02,261 - __main__ - DEBUG - WorkflowManager initialized successfully
2025-02-04 19:47:02,261 - __main__ - DEBUG - Initializing TemplateManager...
2025-02-04 19:47:02,261 - __main__ - DEBUG - TemplateManager initialized successfully
2025-02-04 19:47:02,261 - __main__ - DEBUG - Server settings configured
2025-02-04 19:47:02,261 - __main__ - DEBUG - Starting main application
2025-02-04 19:47:02,262 - __main__ - DEBUG - Initial session state: {'auth_error': None, 'page': 'Dashboard', 'user_info': None, 'last_activity': 1738716418.926816, 'google_signin': True, 'connection_attempts': 0, 'authenticated': False, 'auth_flow_started': False, 'initialized': True}
2025-02-04 19:47:02,262 - __main__ - DEBUG - Session state after initialization: {'auth_error': None, 'page': 'Dashboard', 'user_info': None, 'last_activity': 1738716422.262126, 'google_signin': True, 'connection_attempts': 0, 'authenticated': False, 'auth_flow_started': False, 'initialized': True}
2025-02-04 19:47:02,262 - __main__ - DEBUG - Checking for OAuth callback parameters
2025-02-04 19:47:02,262 - __main__ - DEBUG - Query parameters: {}
2025-02-04 19:47:02,262 - __main__ - DEBUG - User not authenticated, showing auth page
2025-02-04 19:47:02,262 - __main__ - DEBUG - Rendering authentication page
2025-02-04 19:47:02,262 - __main__ - DEBUG - Current session state: {'auth_error': None, 'page': 'Dashboard', 'user_info': None, 'last_activity': 1738716422.262126, 'google_signin': True, 'connection_attempts': 0, 'authenticated': False, 'auth_flow_started': False, 'initialized': True}
2025-02-04 19:47:02,263 - __main__ - DEBUG - Showing Google sign-in button
2025-02-04 19:47:02,263 - __main__ - INFO - Google sign-in button clicked
2025-02-04 19:47:02,263 - __main__ - DEBUG - Starting Google OAuth authentication flow
2025-02-04 19:47:02,264 - __main__ - DEBUG - Received query parameters: {}
2025-02-04 19:47:02,264 - __main__ - DEBUG - Auth code present: False
2025-02-04 19:47:02,264 - __main__ - DEBUG - State present: False
2025-02-04 19:47:02,264 - __main__ - DEBUG - Current session state: {'auth_error': None, 'page': 'Dashboard', 'user_info': None, 'last_activity': 1738716422.262126, 'google_signin': True, 'connection_attempts': 0, 'authenticated': False, 'auth_flow_started': False, 'initialized': True}
2025-02-04 19:47:02,264 - __main__ - INFO - Initiating Google OAuth flow...
2025-02-04 19:47:02,264 - __main__ - DEBUG - Generated auth URL: https://accounts.google.com/o/oauth2/v2/auth?client_id=183173833346-kmsle3f3phtd3f71jms96q3uvcoqv0vu.apps.googleusercontent.com&redirect_uri=http%3A//localhost%3A8501&response_type=code&scope=openid%20email%20profile&access_type=offline&state=MYU_66MqkdWZfQUq9Me2yzZgFCg-lQyi8AIwJRBh5R0&prompt=consent&include_granted_scopes=true
2025-02-04 19:47:02,264 - __main__ - DEBUG - Auth flow started flag set to True
2025-02-04 19:47:02,264 - __main__ - DEBUG - Session state before redirect: {'auth_error': None, 'page': 'Dashboard', 'user_info': None, 'last_activity': 1738716422.262126, 'google_signin': True, 'connection_attempts': 0, 'authenticated': False, 'auth_flow_started': True, 'initialized': True}
2025-02-04 19:47:02,264 - __main__ - INFO - Redirecting to Google OAuth consent screen...
2025-02-04 19:51:01,510 - __main__ - DEBUG - Python version: 3.12.5 (v3.12.5:ff3bc82f7c9, Aug  7 2024, 05:32:06) [Clang 13.0.0 (clang-1300.0.29.30)]
2025-02-04 19:51:01,510 - __main__ - DEBUG - Python executable: /Users/sailesh/Documents/GitHub/aiagent/venv/bin/python3.12
2025-02-04 19:51:01,510 - __main__ - DEBUG - Current working directory: /Users/sailesh/Documents/GitHub/invoiceAgent
2025-02-04 19:51:01,510 - __main__ - DEBUG - PYTHONPATH: Not set
2025-02-04 19:51:01,510 - __main__ - DEBUG - Sys.path: ['src/invoice_agent/ui/app.py', 'src/invoice_agent/ui', '/Users/sailesh/Documents/GitHub/aiagent/venv/bin', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python312.zip', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/lib-dynload', '/Users/sailesh/Documents/GitHub/aiagent/venv/lib/python3.12/site-packages']
2025-02-04 19:51:01,511 - __main__ - DEBUG - Environment variables loaded
2025-02-04 19:51:01,512 - __main__ - DEBUG - Attempting to import invoice_agent modules...
2025-02-04 19:51:01,512 - __main__ - DEBUG - Adding project root to sys.path: /Users/sailesh/Documents/GitHub/invoiceAgent
2025-02-04 19:51:01,512 - __main__ - DEBUG - Importing invoice_agent modules...
2025-02-04 19:51:01,512 - __main__ - ERROR - Import error: No module named 'invoice_agent'
Traceback (most recent call last):
  File "/Users/sailesh/Documents/GitHub/invoiceAgent/src/invoice_agent/ui/app.py", line 53, in <module>
    from invoice_agent.core.invoice_processor import InvoiceAgent
ModuleNotFoundError: No module named 'invoice_agent'
2025-02-04 19:51:01,513 - __main__ - ERROR - Current sys.path: ['/Users/sailesh/Documents/GitHub/invoiceAgent', 'src/invoice_agent/ui/app.py', 'src/invoice_agent/ui', '/Users/sailesh/Documents/GitHub/aiagent/venv/bin', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python312.zip', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/lib-dynload', '/Users/sailesh/Documents/GitHub/aiagent/venv/lib/python3.12/site-packages']
2025-02-04 19:51:45,709 - __main__ - DEBUG - Python version: 3.12.5 (v3.12.5:ff3bc82f7c9, Aug  7 2024, 05:32:06) [Clang 13.0.0 (clang-1300.0.29.30)]
2025-02-04 19:51:45,709 - __main__ - DEBUG - Python executable: /Users/sailesh/Documents/GitHub/aiagent/venv/bin/python3.12
2025-02-04 19:51:45,709 - __main__ - DEBUG - Current working directory: /Users/sailesh/Documents/GitHub/invoiceAgent
2025-02-04 19:51:45,709 - __main__ - DEBUG - PYTHONPATH: :/Users/sailesh/Documents/GitHub/invoiceAgent/src
2025-02-04 19:51:45,709 - __main__ - DEBUG - Sys.path: ['src/invoice_agent/ui/app.py', 'src/invoice_agent/ui', '/Users/sailesh/Documents/GitHub/aiagent/venv/bin', '/Users/sailesh/Documents/GitHub/invoiceAgent', '/Users/sailesh/Documents/GitHub/invoiceAgent/src', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python312.zip', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/lib-dynload', '/Users/sailesh/Documents/GitHub/aiagent/venv/lib/python3.12/site-packages']
2025-02-04 19:51:45,710 - __main__ - DEBUG - Environment variables loaded
2025-02-04 19:51:45,710 - __main__ - DEBUG - Attempting to import invoice_agent modules...
2025-02-04 19:51:45,711 - __main__ - DEBUG - Importing invoice_agent modules...
2025-02-04 19:51:48,340 - invoice_agent.security.auth - INFO - AuthManager initialized with redirect URI: http://localhost:8501
2025-02-04 19:51:48,340 - invoice_agent.security.auth - INFO - Using Streamlit port: 8501
2025-02-04 19:51:48,340 - invoice_agent.security.auth - DEBUG - Google Client ID configured: True
2025-02-04 19:51:48,340 - invoice_agent.security.auth - DEBUG - Google Client Secret configured: True
2025-02-04 19:51:48,364 - __main__ - DEBUG - Imported InvoiceAgent
2025-02-04 19:51:48,364 - __main__ - DEBUG - Imported config_loader
2025-02-04 19:51:48,364 - __main__ - DEBUG - Imported AuthManager
2025-02-04 19:51:48,364 - __main__ - DEBUG - Imported TemplateManager
2025-02-04 19:51:48,364 - __main__ - DEBUG - Imported WorkflowManager
2025-02-04 19:51:48,364 - __main__ - DEBUG - Imported MetricsManager
2025-02-04 19:51:48,364 - __main__ - DEBUG - Initializing AuthManager...
2025-02-04 19:51:48,364 - invoice_agent.security.auth - INFO - AuthManager initialized with redirect URI: http://localhost:8501
2025-02-04 19:51:48,364 - invoice_agent.security.auth - INFO - Using Streamlit port: 8501
2025-02-04 19:51:48,364 - invoice_agent.security.auth - DEBUG - Google Client ID configured: True
2025-02-04 19:51:48,364 - invoice_agent.security.auth - DEBUG - Google Client Secret configured: True
2025-02-04 19:51:48,364 - __main__ - DEBUG - AuthManager initialized successfully
2025-02-04 19:51:48,364 - __main__ - DEBUG - Initializing MetricsManager...
2025-02-04 19:51:48,365 - __main__ - DEBUG - MetricsManager initialized successfully
2025-02-04 19:51:48,365 - __main__ - DEBUG - Initializing InvoiceAgent...
2025-02-04 19:51:48,368 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): huggingface.co:443
2025-02-04 19:51:48,521 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-02-04 19:51:48,599 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-02-04 19:51:48,736 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/processor_config.json HTTP/1.1" 404 0
2025-02-04 19:51:48,840 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/chat_template.json HTTP/1.1" 404 0
2025-02-04 19:51:48,894 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-02-04 19:51:49,090 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/config.json HTTP/1.1" 200 0
2025-02-04 19:51:49,177 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/config.json HTTP/1.1" 200 0
2025-02-04 19:51:49,295 - __main__ - DEBUG - InvoiceAgent initialized successfully
2025-02-04 19:51:49,295 - __main__ - DEBUG - Initializing WorkflowManager...
2025-02-04 19:51:49,297 - __main__ - DEBUG - WorkflowManager initialized successfully
2025-02-04 19:51:49,297 - __main__ - DEBUG - Initializing TemplateManager...
2025-02-04 19:51:49,297 - __main__ - DEBUG - TemplateManager initialized successfully
2025-02-04 19:51:49,297 - __main__ - DEBUG - Server settings configured
2025-02-04 19:51:49,299 - __main__ - DEBUG - Starting main application
2025-02-04 19:51:49,299 - __main__ - DEBUG - Initial session state: {}
2025-02-04 19:51:49,300 - __main__ - DEBUG - Session state after initialization: {'user_info': None, 'page': 'Dashboard', 'authenticated': False, 'initialized': True, 'auth_flow_started': False, 'last_activity': 1738716709.300086, 'connection_attempts': 0, 'auth_error': None}
2025-02-04 19:51:49,300 - __main__ - DEBUG - Checking for OAuth callback parameters
2025-02-04 19:51:49,300 - __main__ - DEBUG - Query parameters: {}
2025-02-04 19:51:49,301 - __main__ - DEBUG - User not authenticated, showing auth page
2025-02-04 19:51:49,301 - __main__ - DEBUG - Rendering authentication page
2025-02-04 19:51:49,301 - __main__ - DEBUG - Current session state: {'user_info': None, 'page': 'Dashboard', 'authenticated': False, 'initialized': True, 'auth_flow_started': False, 'last_activity': 1738716709.300086, 'connection_attempts': 0, 'auth_error': None}
2025-02-04 19:51:49,301 - __main__ - DEBUG - Showing Google sign-in button
2025-02-04 19:51:49,302 - __main__ - DEBUG - Showing Microsoft sign-in button
2025-02-04 19:51:49,302 - __main__ - DEBUG - Showing Service Account sign-in form
2025-02-04 19:51:52,005 - __main__ - DEBUG - Python version: 3.12.5 (v3.12.5:ff3bc82f7c9, Aug  7 2024, 05:32:06) [Clang 13.0.0 (clang-1300.0.29.30)]
2025-02-04 19:51:52,006 - __main__ - DEBUG - Python executable: /Users/sailesh/Documents/GitHub/aiagent/venv/bin/python3.12
2025-02-04 19:51:52,007 - __main__ - DEBUG - Current working directory: /Users/sailesh/Documents/GitHub/invoiceAgent
2025-02-04 19:51:52,007 - __main__ - DEBUG - PYTHONPATH: :/Users/sailesh/Documents/GitHub/invoiceAgent/src
2025-02-04 19:51:52,007 - __main__ - DEBUG - Sys.path: ['src/invoice_agent/ui/app.py', 'src/invoice_agent/ui', '/Users/sailesh/Documents/GitHub/aiagent/venv/bin', '/Users/sailesh/Documents/GitHub/invoiceAgent', '/Users/sailesh/Documents/GitHub/invoiceAgent/src', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python312.zip', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/lib-dynload', '/Users/sailesh/Documents/GitHub/aiagent/venv/lib/python3.12/site-packages', '/var/folders/0c/vbd1lzvs6p35p66t1zm047sh0000gn/T/tmpzih7__4w']
2025-02-04 19:51:52,012 - __main__ - DEBUG - Environment variables loaded
2025-02-04 19:51:52,013 - __main__ - DEBUG - Attempting to import invoice_agent modules...
2025-02-04 19:51:52,013 - __main__ - DEBUG - Importing invoice_agent modules...
2025-02-04 19:51:52,013 - __main__ - DEBUG - Imported InvoiceAgent
2025-02-04 19:51:52,013 - __main__ - DEBUG - Imported config_loader
2025-02-04 19:51:52,013 - __main__ - DEBUG - Imported AuthManager
2025-02-04 19:51:52,013 - __main__ - DEBUG - Imported TemplateManager
2025-02-04 19:51:52,013 - __main__ - DEBUG - Imported WorkflowManager
2025-02-04 19:51:52,013 - __main__ - DEBUG - Imported MetricsManager
2025-02-04 19:51:52,013 - __main__ - DEBUG - Initializing AuthManager...
2025-02-04 19:51:52,014 - invoice_agent.security.auth - INFO - AuthManager initialized with redirect URI: http://localhost:8501
2025-02-04 19:51:52,014 - invoice_agent.security.auth - INFO - Using Streamlit port: 8501
2025-02-04 19:51:52,015 - invoice_agent.security.auth - DEBUG - Google Client ID configured: True
2025-02-04 19:51:52,015 - invoice_agent.security.auth - DEBUG - Google Client Secret configured: True
2025-02-04 19:51:52,016 - __main__ - DEBUG - AuthManager initialized successfully
2025-02-04 19:51:52,016 - __main__ - DEBUG - Initializing MetricsManager...
2025-02-04 19:51:52,016 - __main__ - DEBUG - MetricsManager initialized successfully
2025-02-04 19:51:52,016 - __main__ - DEBUG - Initializing InvoiceAgent...
2025-02-04 19:51:52,104 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-02-04 19:51:52,160 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-02-04 19:51:52,383 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/processor_config.json HTTP/1.1" 404 0
2025-02-04 19:51:52,434 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/chat_template.json HTTP/1.1" 404 0
2025-02-04 19:51:52,487 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-02-04 19:51:52,654 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/config.json HTTP/1.1" 200 0
2025-02-04 19:51:52,706 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/config.json HTTP/1.1" 200 0
2025-02-04 19:51:52,742 - __main__ - DEBUG - InvoiceAgent initialized successfully
2025-02-04 19:51:52,743 - __main__ - DEBUG - Initializing WorkflowManager...
2025-02-04 19:51:52,744 - __main__ - DEBUG - WorkflowManager initialized successfully
2025-02-04 19:51:52,744 - __main__ - DEBUG - Initializing TemplateManager...
2025-02-04 19:51:52,744 - __main__ - DEBUG - TemplateManager initialized successfully
2025-02-04 19:51:52,744 - __main__ - DEBUG - Server settings configured
2025-02-04 19:51:52,744 - __main__ - DEBUG - Starting main application
2025-02-04 19:51:52,745 - __main__ - DEBUG - Initial session state: {'google_signin': True, 'user_info': None, 'page': 'Dashboard', 'authenticated': False, 'initialized': True, 'auth_flow_started': False, 'last_activity': 1738716709.300086, 'connection_attempts': 0, 'auth_error': None}
2025-02-04 19:51:52,745 - __main__ - DEBUG - Session state after initialization: {'google_signin': True, 'user_info': None, 'page': 'Dashboard', 'authenticated': False, 'initialized': True, 'auth_flow_started': False, 'last_activity': 1738716712.7451048, 'connection_attempts': 0, 'auth_error': None}
2025-02-04 19:51:52,745 - __main__ - DEBUG - Checking for OAuth callback parameters
2025-02-04 19:51:52,745 - __main__ - DEBUG - Query parameters: {}
2025-02-04 19:51:52,745 - __main__ - DEBUG - User not authenticated, showing auth page
2025-02-04 19:51:52,745 - __main__ - DEBUG - Rendering authentication page
2025-02-04 19:51:52,745 - __main__ - DEBUG - Current session state: {'google_signin': True, 'user_info': None, 'page': 'Dashboard', 'authenticated': False, 'initialized': True, 'auth_flow_started': False, 'last_activity': 1738716712.7451048, 'connection_attempts': 0, 'auth_error': None}
2025-02-04 19:51:52,746 - __main__ - DEBUG - Showing Google sign-in button
2025-02-04 19:51:52,746 - __main__ - INFO - Google sign-in button clicked
2025-02-04 19:51:52,746 - __main__ - DEBUG - Starting Google OAuth authentication flow
2025-02-04 19:51:52,746 - __main__ - DEBUG - Received query parameters: {}
2025-02-04 19:51:52,747 - __main__ - DEBUG - Auth code present: False
2025-02-04 19:51:52,747 - __main__ - DEBUG - State present: False
2025-02-04 19:51:52,747 - __main__ - DEBUG - Current session state: {'google_signin': True, 'user_info': None, 'page': 'Dashboard', 'authenticated': False, 'initialized': True, 'auth_flow_started': False, 'last_activity': 1738716712.7451048, 'connection_attempts': 0, 'auth_error': None}
2025-02-04 19:51:52,747 - __main__ - INFO - Initiating Google OAuth flow...
2025-02-04 19:51:52,747 - invoice_agent.security.auth - DEBUG - Generated new state token: fX3bC5XN0c...
2025-02-04 19:51:52,747 - invoice_agent.security.auth - DEBUG - Using redirect URI: http://localhost:8501
2025-02-04 19:51:52,747 - invoice_agent.security.auth - INFO - Generated auth URL with state token: fX3bC5XN0c...
2025-02-04 19:51:52,747 - invoice_agent.security.auth - DEBUG - Full auth URL: https://accounts.google.com/o/oauth2/v2/auth?client_id=183173833346-kmsle3f3phtd3f71jms96q3uvcoqv0vu.apps.googleusercontent.com&redirect_uri=http%3A%2F%2Flocalhost%3A8501&response_type=code&scope=openid+email+profile&access_type=offline&state=fX3bC5XN0cC8scuapsl0a1ZSOiUDTrC8o9ShYkrPqKE&prompt=consent&include_granted_scopes=true
2025-02-04 19:51:52,747 - __main__ - DEBUG - Generated auth URL: https://accounts.google.com/o/oauth2/v2/auth?client_id=183173833346-kmsle3f3phtd3f71jms96q3uvcoqv0vu.apps.googleusercontent.com&redirect_uri=http%3A%2F%2Flocalhost%3A8501&response_type=code&scope=openid+email+profile&access_type=offline&state=fX3bC5XN0cC8scuapsl0a1ZSOiUDTrC8o9ShYkrPqKE&prompt=consent&include_granted_scopes=true
2025-02-04 19:51:52,747 - __main__ - DEBUG - Auth flow started flag set to True
2025-02-04 19:51:52,747 - __main__ - DEBUG - Session state before redirect: {'google_signin': True, 'user_info': None, 'page': 'Dashboard', 'authenticated': False, 'initialized': True, 'auth_flow_started': True, 'last_activity': 1738716712.7451048, 'connection_attempts': 0, 'auth_error': None}
2025-02-04 19:51:52,747 - __main__ - INFO - Redirecting to Google OAuth consent screen...
2025-02-04 19:55:16,270 - __main__ - DEBUG - Python version: 3.12.5 (v3.12.5:ff3bc82f7c9, Aug  7 2024, 05:32:06) [Clang 13.0.0 (clang-1300.0.29.30)]
2025-02-04 19:55:16,270 - __main__ - DEBUG - Python executable: /Users/sailesh/Documents/GitHub/aiagent/venv/bin/python3.12
2025-02-04 19:55:16,270 - __main__ - DEBUG - Current working directory: /Users/sailesh/Documents/GitHub/invoiceAgent
2025-02-04 19:55:16,270 - __main__ - DEBUG - PYTHONPATH: :/Users/sailesh/Documents/GitHub/invoiceAgent/src
2025-02-04 19:55:16,270 - __main__ - DEBUG - Sys.path: ['src/invoice_agent/ui/app.py', 'src/invoice_agent/ui', '/Users/sailesh/Documents/GitHub/aiagent/venv/bin', '/Users/sailesh/Documents/GitHub/invoiceAgent', '/Users/sailesh/Documents/GitHub/invoiceAgent/src', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python312.zip', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/lib-dynload', '/Users/sailesh/Documents/GitHub/aiagent/venv/lib/python3.12/site-packages']
2025-02-04 19:55:16,271 - __main__ - DEBUG - Environment variables loaded
2025-02-04 19:55:16,271 - __main__ - DEBUG - Attempting to import invoice_agent modules...
2025-02-04 19:55:16,272 - __main__ - DEBUG - Importing invoice_agent modules...
2025-02-04 19:55:18,842 - invoice_agent.security.auth - INFO - AuthManager initialized with redirect URI: http://localhost:8501
2025-02-04 19:55:18,843 - invoice_agent.security.auth - INFO - Using Streamlit port: 8501
2025-02-04 19:55:18,843 - invoice_agent.security.auth - DEBUG - Google Client ID configured: True
2025-02-04 19:55:18,843 - invoice_agent.security.auth - DEBUG - Google Client Secret configured: True
2025-02-04 19:55:18,863 - __main__ - DEBUG - Imported InvoiceAgent
2025-02-04 19:55:18,863 - __main__ - DEBUG - Imported config_loader
2025-02-04 19:55:18,863 - __main__ - DEBUG - Imported AuthManager
2025-02-04 19:55:18,863 - __main__ - DEBUG - Imported TemplateManager
2025-02-04 19:55:18,863 - __main__ - DEBUG - Imported WorkflowManager
2025-02-04 19:55:18,863 - __main__ - DEBUG - Imported MetricsManager
2025-02-04 19:55:18,863 - __main__ - DEBUG - Initializing AuthManager...
2025-02-04 19:55:18,863 - invoice_agent.security.auth - INFO - AuthManager initialized with redirect URI: http://localhost:8501
2025-02-04 19:55:18,863 - invoice_agent.security.auth - INFO - Using Streamlit port: 8501
2025-02-04 19:55:18,863 - invoice_agent.security.auth - DEBUG - Google Client ID configured: True
2025-02-04 19:55:18,863 - invoice_agent.security.auth - DEBUG - Google Client Secret configured: True
2025-02-04 19:55:18,863 - __main__ - DEBUG - AuthManager initialized successfully
2025-02-04 19:55:18,863 - __main__ - DEBUG - Initializing MetricsManager...
2025-02-04 19:55:18,863 - __main__ - DEBUG - MetricsManager initialized successfully
2025-02-04 19:55:18,863 - __main__ - DEBUG - Initializing InvoiceAgent...
2025-02-04 19:55:18,866 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): huggingface.co:443
2025-02-04 19:55:18,994 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-02-04 19:55:19,065 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-02-04 19:55:19,208 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/processor_config.json HTTP/1.1" 404 0
2025-02-04 19:55:19,333 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/chat_template.json HTTP/1.1" 404 0
2025-02-04 19:55:19,393 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-02-04 19:55:19,573 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/config.json HTTP/1.1" 200 0
2025-02-04 19:55:19,624 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/config.json HTTP/1.1" 200 0
2025-02-04 19:55:19,731 - __main__ - DEBUG - InvoiceAgent initialized successfully
2025-02-04 19:55:19,731 - __main__ - DEBUG - Initializing WorkflowManager...
2025-02-04 19:55:19,733 - __main__ - DEBUG - WorkflowManager initialized successfully
2025-02-04 19:55:19,733 - __main__ - DEBUG - Initializing TemplateManager...
2025-02-04 19:55:19,733 - __main__ - DEBUG - TemplateManager initialized successfully
2025-02-04 19:55:19,733 - __main__ - DEBUG - Server settings configured
2025-02-04 19:55:19,735 - __main__ - DEBUG - Starting main application
2025-02-04 19:55:19,735 - __main__ - DEBUG - Initial session state: {}
2025-02-04 19:55:19,736 - __main__ - DEBUG - Session state after initialization: {'auth_error': None, 'page': 'Dashboard', 'connection_attempts': 0, 'authenticated': False, 'auth_flow_started': False, 'last_activity': 1738716919.7359848, 'user_info': None, 'initialized': True}
2025-02-04 19:55:19,736 - __main__ - DEBUG - Checking for OAuth callback parameters
2025-02-04 19:55:19,736 - __main__ - DEBUG - Query parameters: {}
2025-02-04 19:55:19,736 - __main__ - DEBUG - User not authenticated, showing auth page
2025-02-04 19:55:19,736 - __main__ - DEBUG - Rendering authentication page
2025-02-04 19:55:19,736 - __main__ - DEBUG - Current session state: {'auth_error': None, 'page': 'Dashboard', 'connection_attempts': 0, 'authenticated': False, 'auth_flow_started': False, 'last_activity': 1738716919.7359848, 'user_info': None, 'initialized': True}
2025-02-04 19:55:19,737 - __main__ - DEBUG - Showing Google sign-in button
2025-02-04 19:55:19,738 - __main__ - DEBUG - Showing Microsoft sign-in button
2025-02-04 19:55:19,738 - __main__ - DEBUG - Showing Service Account sign-in form
2025-02-04 19:57:58,422 - __main__ - DEBUG - Python version: 3.12.5 (v3.12.5:ff3bc82f7c9, Aug  7 2024, 05:32:06) [Clang 13.0.0 (clang-1300.0.29.30)]
2025-02-04 19:57:58,422 - __main__ - DEBUG - Python executable: /Users/sailesh/Documents/GitHub/aiagent/venv/bin/python3.12
2025-02-04 19:57:58,422 - __main__ - DEBUG - Current working directory: /Users/sailesh/Documents/GitHub/invoiceAgent
2025-02-04 19:57:58,422 - __main__ - DEBUG - PYTHONPATH: :/Users/sailesh/Documents/GitHub/invoiceAgent/src
2025-02-04 19:57:58,422 - __main__ - DEBUG - Sys.path: ['src/invoice_agent/ui/app.py', 'src/invoice_agent/ui', '/Users/sailesh/Documents/GitHub/aiagent/venv/bin', '/Users/sailesh/Documents/GitHub/invoiceAgent', '/Users/sailesh/Documents/GitHub/invoiceAgent/src', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python312.zip', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/lib-dynload', '/Users/sailesh/Documents/GitHub/aiagent/venv/lib/python3.12/site-packages']
2025-02-04 19:57:58,423 - __main__ - DEBUG - Environment variables loaded
2025-02-04 19:57:58,423 - __main__ - DEBUG - Attempting to import invoice_agent modules...
2025-02-04 19:57:58,424 - __main__ - DEBUG - Importing invoice_agent modules...
2025-02-04 19:58:01,032 - invoice_agent.security.auth - INFO - AuthManager initialized with redirect URI: http://localhost:8501
2025-02-04 19:58:01,032 - invoice_agent.security.auth - INFO - Using Streamlit port: 8501
2025-02-04 19:58:01,032 - invoice_agent.security.auth - DEBUG - Google Client ID configured: True
2025-02-04 19:58:01,032 - invoice_agent.security.auth - DEBUG - Google Client Secret configured: True
2025-02-04 19:58:01,054 - __main__ - DEBUG - Imported InvoiceAgent
2025-02-04 19:58:01,055 - __main__ - DEBUG - Imported config_loader
2025-02-04 19:58:01,055 - __main__ - DEBUG - Imported AuthManager
2025-02-04 19:58:01,055 - __main__ - DEBUG - Imported TemplateManager
2025-02-04 19:58:01,055 - __main__ - DEBUG - Imported WorkflowManager
2025-02-04 19:58:01,055 - __main__ - DEBUG - Imported MetricsManager
2025-02-04 19:58:01,055 - __main__ - DEBUG - Initializing AuthManager...
2025-02-04 19:58:01,055 - invoice_agent.security.auth - INFO - AuthManager initialized with redirect URI: http://localhost:8501
2025-02-04 19:58:01,055 - invoice_agent.security.auth - INFO - Using Streamlit port: 8501
2025-02-04 19:58:01,055 - invoice_agent.security.auth - DEBUG - Google Client ID configured: True
2025-02-04 19:58:01,055 - invoice_agent.security.auth - DEBUG - Google Client Secret configured: True
2025-02-04 19:58:01,055 - __main__ - DEBUG - AuthManager initialized successfully
2025-02-04 19:58:01,055 - __main__ - DEBUG - Initializing MetricsManager...
2025-02-04 19:58:01,055 - __main__ - DEBUG - MetricsManager initialized successfully
2025-02-04 19:58:01,055 - __main__ - DEBUG - Initializing InvoiceAgent...
2025-02-04 19:58:01,059 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): huggingface.co:443
2025-02-04 19:58:01,206 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-02-04 19:58:01,299 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-02-04 19:58:01,479 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/processor_config.json HTTP/1.1" 404 0
2025-02-04 19:58:01,536 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/chat_template.json HTTP/1.1" 404 0
2025-02-04 19:58:01,600 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-02-04 19:58:01,920 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/config.json HTTP/1.1" 200 0
2025-02-04 19:58:01,988 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/config.json HTTP/1.1" 200 0
2025-02-04 19:58:02,112 - __main__ - DEBUG - InvoiceAgent initialized successfully
2025-02-04 19:58:02,112 - __main__ - DEBUG - Initializing WorkflowManager...
2025-02-04 19:58:02,113 - __main__ - DEBUG - WorkflowManager initialized successfully
2025-02-04 19:58:02,113 - __main__ - DEBUG - Initializing TemplateManager...
2025-02-04 19:58:02,114 - __main__ - DEBUG - TemplateManager initialized successfully
2025-02-04 19:58:02,114 - __main__ - DEBUG - Server settings configured
2025-02-04 19:58:02,116 - __main__ - DEBUG - Starting main application
2025-02-04 19:58:02,116 - __main__ - DEBUG - Initial session state: {}
2025-02-04 19:58:02,117 - __main__ - DEBUG - Session state after initialization: {'auth_error': None, 'connection_attempts': 0, 'authenticated': False, 'initialized': True, 'page': 'Dashboard', 'last_activity': 1738717082.117034, 'auth_flow_started': False, 'user_info': None}
2025-02-04 19:58:02,117 - __main__ - DEBUG - Checking for OAuth callback parameters
2025-02-04 19:58:02,117 - __main__ - DEBUG - Query parameters: {}
2025-02-04 19:58:02,117 - __main__ - DEBUG - User not authenticated, showing auth page
2025-02-04 19:58:02,117 - __main__ - DEBUG - Rendering authentication page
2025-02-04 19:58:02,117 - __main__ - DEBUG - Current session state: {'auth_error': None, 'connection_attempts': 0, 'authenticated': False, 'initialized': True, 'page': 'Dashboard', 'last_activity': 1738717082.117034, 'auth_flow_started': False, 'user_info': None}
2025-02-04 19:58:02,119 - __main__ - DEBUG - Showing Google sign-in button
2025-02-04 19:58:02,119 - __main__ - DEBUG - Showing Microsoft sign-in button
2025-02-04 19:58:02,119 - __main__ - DEBUG - Showing Service Account sign-in form
2025-02-04 19:58:03,458 - __main__ - DEBUG - Python version: 3.12.5 (v3.12.5:ff3bc82f7c9, Aug  7 2024, 05:32:06) [Clang 13.0.0 (clang-1300.0.29.30)]
2025-02-04 19:58:03,458 - __main__ - DEBUG - Python executable: /Users/sailesh/Documents/GitHub/aiagent/venv/bin/python3.12
2025-02-04 19:58:03,459 - __main__ - DEBUG - Current working directory: /Users/sailesh/Documents/GitHub/invoiceAgent
2025-02-04 19:58:03,459 - __main__ - DEBUG - PYTHONPATH: :/Users/sailesh/Documents/GitHub/invoiceAgent/src
2025-02-04 19:58:03,459 - __main__ - DEBUG - Sys.path: ['src/invoice_agent/ui/app.py', 'src/invoice_agent/ui', '/Users/sailesh/Documents/GitHub/aiagent/venv/bin', '/Users/sailesh/Documents/GitHub/invoiceAgent', '/Users/sailesh/Documents/GitHub/invoiceAgent/src', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python312.zip', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/lib-dynload', '/Users/sailesh/Documents/GitHub/aiagent/venv/lib/python3.12/site-packages', '/var/folders/0c/vbd1lzvs6p35p66t1zm047sh0000gn/T/tmphkrgdlt2']
2025-02-04 19:58:03,462 - __main__ - DEBUG - Environment variables loaded
2025-02-04 19:58:03,462 - __main__ - DEBUG - Attempting to import invoice_agent modules...
2025-02-04 19:58:03,463 - __main__ - DEBUG - Importing invoice_agent modules...
2025-02-04 19:58:03,463 - __main__ - DEBUG - Imported InvoiceAgent
2025-02-04 19:58:03,463 - __main__ - DEBUG - Imported config_loader
2025-02-04 19:58:03,463 - __main__ - DEBUG - Imported AuthManager
2025-02-04 19:58:03,463 - __main__ - DEBUG - Imported TemplateManager
2025-02-04 19:58:03,463 - __main__ - DEBUG - Imported WorkflowManager
2025-02-04 19:58:03,463 - __main__ - DEBUG - Imported MetricsManager
2025-02-04 19:58:03,463 - __main__ - DEBUG - Initializing AuthManager...
2025-02-04 19:58:03,463 - invoice_agent.security.auth - INFO - AuthManager initialized with redirect URI: http://localhost:8501
2025-02-04 19:58:03,463 - invoice_agent.security.auth - INFO - Using Streamlit port: 8501
2025-02-04 19:58:03,463 - invoice_agent.security.auth - DEBUG - Google Client ID configured: True
2025-02-04 19:58:03,463 - invoice_agent.security.auth - DEBUG - Google Client Secret configured: True
2025-02-04 19:58:03,464 - __main__ - DEBUG - AuthManager initialized successfully
2025-02-04 19:58:03,464 - __main__ - DEBUG - Initializing MetricsManager...
2025-02-04 19:58:03,464 - __main__ - DEBUG - MetricsManager initialized successfully
2025-02-04 19:58:03,464 - __main__ - DEBUG - Initializing InvoiceAgent...
2025-02-04 19:58:03,593 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-02-04 19:58:03,653 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-02-04 19:58:03,804 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/processor_config.json HTTP/1.1" 404 0
2025-02-04 19:58:03,922 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/chat_template.json HTTP/1.1" 404 0
2025-02-04 19:58:04,043 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-02-04 19:58:04,218 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/config.json HTTP/1.1" 200 0
2025-02-04 19:58:04,321 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/config.json HTTP/1.1" 200 0
2025-02-04 19:58:04,365 - __main__ - DEBUG - InvoiceAgent initialized successfully
2025-02-04 19:58:04,365 - __main__ - DEBUG - Initializing WorkflowManager...
2025-02-04 19:58:04,366 - __main__ - DEBUG - WorkflowManager initialized successfully
2025-02-04 19:58:04,366 - __main__ - DEBUG - Initializing TemplateManager...
2025-02-04 19:58:04,366 - __main__ - DEBUG - TemplateManager initialized successfully
2025-02-04 19:58:04,366 - __main__ - DEBUG - Server settings configured
2025-02-04 19:58:04,366 - __main__ - DEBUG - Starting main application
2025-02-04 19:58:04,367 - __main__ - DEBUG - Initial session state: {'auth_error': None, 'connection_attempts': 0, 'authenticated': False, 'initialized': True, 'google_signin': True, 'page': 'Dashboard', 'last_activity': 1738717082.117034, 'auth_flow_started': False, 'user_info': None}
2025-02-04 19:58:04,367 - __main__ - DEBUG - Session state after initialization: {'auth_error': None, 'connection_attempts': 0, 'authenticated': False, 'initialized': True, 'google_signin': True, 'page': 'Dashboard', 'last_activity': 1738717084.3671832, 'auth_flow_started': False, 'user_info': None}
2025-02-04 19:58:04,367 - __main__ - DEBUG - Checking for OAuth callback parameters
2025-02-04 19:58:04,367 - __main__ - DEBUG - Query parameters: {}
2025-02-04 19:58:04,367 - __main__ - DEBUG - User not authenticated, showing auth page
2025-02-04 19:58:04,367 - __main__ - DEBUG - Rendering authentication page
2025-02-04 19:58:04,367 - __main__ - DEBUG - Current session state: {'auth_error': None, 'connection_attempts': 0, 'authenticated': False, 'initialized': True, 'google_signin': True, 'page': 'Dashboard', 'last_activity': 1738717084.3671832, 'auth_flow_started': False, 'user_info': None}
2025-02-04 19:58:04,368 - __main__ - DEBUG - Showing Google sign-in button
2025-02-04 19:58:04,369 - __main__ - INFO - Google sign-in button clicked
2025-02-04 19:58:04,369 - __main__ - DEBUG - Starting Google OAuth authentication flow
2025-02-04 19:58:04,369 - __main__ - DEBUG - Received query parameters: {}
2025-02-04 19:58:04,369 - __main__ - DEBUG - Auth code present: False
2025-02-04 19:58:04,369 - __main__ - DEBUG - State present: False
2025-02-04 19:58:04,369 - __main__ - DEBUG - Current session state: {'auth_error': None, 'connection_attempts': 0, 'authenticated': False, 'initialized': True, 'google_signin': True, 'page': 'Dashboard', 'last_activity': 1738717084.3671832, 'auth_flow_started': False, 'user_info': None}
2025-02-04 19:58:04,369 - __main__ - INFO - Initiating Google OAuth flow...
2025-02-04 19:58:04,369 - invoice_agent.security.auth - DEBUG - Generated new state token: 7gtHRHbg4D...
2025-02-04 19:58:04,369 - invoice_agent.security.auth - DEBUG - Using redirect URI: http://localhost:8501
2025-02-04 19:58:04,369 - invoice_agent.security.auth - INFO - Generated auth URL with state token: 7gtHRHbg4D...
2025-02-04 19:58:04,369 - invoice_agent.security.auth - DEBUG - Full auth URL: https://accounts.google.com/o/oauth2/v2/auth?client_id=183173833346-kmsle3f3phtd3f71jms96q3uvcoqv0vu.apps.googleusercontent.com&redirect_uri=http%3A%2F%2Flocalhost%3A8501&response_type=code&scope=openid+email+profile&access_type=offline&state=7gtHRHbg4Dp7wy4CPTLSwh6ZWoxn1QIeTd8i5BUsiPs&prompt=consent&include_granted_scopes=true
2025-02-04 19:58:04,369 - __main__ - DEBUG - Generated auth URL: https://accounts.google.com/o/oauth2/v2/auth?client_id=183173833346-kmsle3f3phtd3f71jms96q3uvcoqv0vu.apps.googleusercontent.com&redirect_uri=http%3A%2F%2Flocalhost%3A8501&response_type=code&scope=openid+email+profile&access_type=offline&state=7gtHRHbg4Dp7wy4CPTLSwh6ZWoxn1QIeTd8i5BUsiPs&prompt=consent&include_granted_scopes=true
2025-02-04 19:58:04,369 - __main__ - DEBUG - Auth flow started flag set to True
2025-02-04 19:58:04,369 - __main__ - DEBUG - Session state before redirect: {'auth_error': None, 'connection_attempts': 0, 'authenticated': False, 'initialized': True, 'google_signin': True, 'page': 'Dashboard', 'last_activity': 1738717084.3671832, 'auth_flow_started': True, 'user_info': None}
2025-02-04 19:58:04,369 - __main__ - INFO - Redirecting to Google OAuth consent screen...
2025-02-04 20:38:38,780 - __main__ - DEBUG - Python version: 3.12.5 (v3.12.5:ff3bc82f7c9, Aug  7 2024, 05:32:06) [Clang 13.0.0 (clang-1300.0.29.30)]
2025-02-04 20:38:38,780 - __main__ - DEBUG - Python executable: /Users/sailesh/Documents/GitHub/aiagent/venv/bin/python3.12
2025-02-04 20:38:38,780 - __main__ - DEBUG - Current working directory: /Users/sailesh/Documents/GitHub/invoiceAgent
2025-02-04 20:38:38,780 - __main__ - DEBUG - PYTHONPATH: :/Users/sailesh/Documents/GitHub/invoiceAgent
2025-02-04 20:38:38,780 - __main__ - DEBUG - Sys.path: ['src/invoice_agent/ui/app.py', 'src/invoice_agent/ui', '/Users/sailesh/Documents/GitHub/aiagent/venv/bin', '/Users/sailesh/Documents/GitHub/invoiceAgent', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python312.zip', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/lib-dynload', '/Users/sailesh/Documents/GitHub/aiagent/venv/lib/python3.12/site-packages']
2025-02-04 20:38:38,782 - __main__ - DEBUG - Environment variables loaded
2025-02-04 20:38:38,782 - __main__ - DEBUG - Attempting to import invoice_agent modules...
2025-02-04 20:38:38,782 - __main__ - DEBUG - Importing invoice_agent modules...
2025-02-04 20:38:38,782 - __main__ - ERROR - Import error: No module named 'invoice_agent'
Traceback (most recent call last):
  File "/Users/sailesh/Documents/GitHub/invoiceAgent/src/invoice_agent/ui/app.py", line 53, in <module>
    from invoice_agent.core.invoice_processor import InvoiceAgent
ModuleNotFoundError: No module named 'invoice_agent'
2025-02-04 20:38:38,783 - __main__ - ERROR - Current sys.path: ['src/invoice_agent/ui/app.py', 'src/invoice_agent/ui', '/Users/sailesh/Documents/GitHub/aiagent/venv/bin', '/Users/sailesh/Documents/GitHub/invoiceAgent', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python312.zip', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/lib-dynload', '/Users/sailesh/Documents/GitHub/aiagent/venv/lib/python3.12/site-packages']
2025-02-04 20:38:41,242 - __main__ - DEBUG - Python version: 3.12.5 (v3.12.5:ff3bc82f7c9, Aug  7 2024, 05:32:06) [Clang 13.0.0 (clang-1300.0.29.30)]
2025-02-04 20:38:41,243 - __main__ - DEBUG - Python executable: /Users/sailesh/Documents/GitHub/aiagent/venv/bin/python3.12
2025-02-04 20:38:41,243 - __main__ - DEBUG - Current working directory: /Users/sailesh/Documents/GitHub/invoiceAgent
2025-02-04 20:38:41,243 - __main__ - DEBUG - PYTHONPATH: :/Users/sailesh/Documents/GitHub/invoiceAgent
2025-02-04 20:38:41,243 - __main__ - DEBUG - Sys.path: ['src/invoice_agent/ui/app.py', 'src/invoice_agent/ui', '/Users/sailesh/Documents/GitHub/aiagent/venv/bin', '/Users/sailesh/Documents/GitHub/invoiceAgent', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python312.zip', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/lib-dynload', '/Users/sailesh/Documents/GitHub/aiagent/venv/lib/python3.12/site-packages']
2025-02-04 20:38:41,246 - __main__ - DEBUG - Environment variables loaded
2025-02-04 20:38:41,246 - __main__ - DEBUG - Attempting to import invoice_agent modules...
2025-02-04 20:38:41,246 - __main__ - DEBUG - Importing invoice_agent modules...
2025-02-04 20:38:41,247 - __main__ - ERROR - Import error: No module named 'invoice_agent'
Traceback (most recent call last):
  File "/Users/sailesh/Documents/GitHub/invoiceAgent/src/invoice_agent/ui/app.py", line 53, in <module>
    from invoice_agent.core.invoice_processor import InvoiceAgent
ModuleNotFoundError: No module named 'invoice_agent'
2025-02-04 20:38:41,247 - __main__ - ERROR - Current sys.path: ['src/invoice_agent/ui/app.py', 'src/invoice_agent/ui', '/Users/sailesh/Documents/GitHub/aiagent/venv/bin', '/Users/sailesh/Documents/GitHub/invoiceAgent', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python312.zip', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/lib-dynload', '/Users/sailesh/Documents/GitHub/aiagent/venv/lib/python3.12/site-packages']
2025-02-04 20:39:09,228 - __main__ - DEBUG - Python version: 3.12.5 (v3.12.5:ff3bc82f7c9, Aug  7 2024, 05:32:06) [Clang 13.0.0 (clang-1300.0.29.30)]
2025-02-04 20:39:09,229 - __main__ - DEBUG - Python executable: /Users/sailesh/Documents/GitHub/aiagent/venv/bin/python3.12
2025-02-04 20:39:09,229 - __main__ - DEBUG - Current working directory: /Users/sailesh/Documents/GitHub/invoiceAgent
2025-02-04 20:39:09,229 - __main__ - DEBUG - PYTHONPATH: :/Users/sailesh/Documents/GitHub/invoiceAgent
2025-02-04 20:39:09,229 - __main__ - DEBUG - Sys.path: ['src/invoice_agent/ui/app.py', 'src/invoice_agent/ui', '/Users/sailesh/Documents/GitHub/aiagent/venv/bin', '/Users/sailesh/Documents/GitHub/invoiceAgent', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python312.zip', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/lib-dynload', '/Users/sailesh/Documents/GitHub/aiagent/venv/lib/python3.12/site-packages']
2025-02-04 20:39:09,231 - __main__ - DEBUG - Environment variables loaded
2025-02-04 20:39:09,231 - __main__ - DEBUG - Attempting to import invoice_agent modules...
2025-02-04 20:39:09,231 - __main__ - DEBUG - Importing invoice_agent modules...
2025-02-04 20:39:09,231 - __main__ - ERROR - Import error: No module named 'invoice_agent'
Traceback (most recent call last):
  File "/Users/sailesh/Documents/GitHub/invoiceAgent/src/invoice_agent/ui/app.py", line 53, in <module>
    from invoice_agent.core.invoice_processor import InvoiceAgent
ModuleNotFoundError: No module named 'invoice_agent'
2025-02-04 20:39:09,232 - __main__ - ERROR - Current sys.path: ['src/invoice_agent/ui/app.py', 'src/invoice_agent/ui', '/Users/sailesh/Documents/GitHub/aiagent/venv/bin', '/Users/sailesh/Documents/GitHub/invoiceAgent', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python312.zip', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/lib-dynload', '/Users/sailesh/Documents/GitHub/aiagent/venv/lib/python3.12/site-packages']
2025-02-04 20:39:11,231 - __main__ - DEBUG - Python version: 3.12.5 (v3.12.5:ff3bc82f7c9, Aug  7 2024, 05:32:06) [Clang 13.0.0 (clang-1300.0.29.30)]
2025-02-04 20:39:11,231 - __main__ - DEBUG - Python executable: /Users/sailesh/Documents/GitHub/aiagent/venv/bin/python3.12
2025-02-04 20:39:11,232 - __main__ - DEBUG - Current working directory: /Users/sailesh/Documents/GitHub/invoiceAgent
2025-02-04 20:39:11,232 - __main__ - DEBUG - PYTHONPATH: :/Users/sailesh/Documents/GitHub/invoiceAgent
2025-02-04 20:39:11,232 - __main__ - DEBUG - Sys.path: ['src/invoice_agent/ui/app.py', 'src/invoice_agent/ui', '/Users/sailesh/Documents/GitHub/aiagent/venv/bin', '/Users/sailesh/Documents/GitHub/invoiceAgent', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python312.zip', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/lib-dynload', '/Users/sailesh/Documents/GitHub/aiagent/venv/lib/python3.12/site-packages']
2025-02-04 20:39:11,235 - __main__ - DEBUG - Environment variables loaded
2025-02-04 20:39:11,235 - __main__ - DEBUG - Attempting to import invoice_agent modules...
2025-02-04 20:39:11,236 - __main__ - DEBUG - Importing invoice_agent modules...
2025-02-04 20:39:11,236 - __main__ - ERROR - Import error: No module named 'invoice_agent'
Traceback (most recent call last):
  File "/Users/sailesh/Documents/GitHub/invoiceAgent/src/invoice_agent/ui/app.py", line 53, in <module>
    from invoice_agent.core.invoice_processor import InvoiceAgent
ModuleNotFoundError: No module named 'invoice_agent'
2025-02-04 20:39:11,237 - __main__ - ERROR - Current sys.path: ['src/invoice_agent/ui/app.py', 'src/invoice_agent/ui', '/Users/sailesh/Documents/GitHub/aiagent/venv/bin', '/Users/sailesh/Documents/GitHub/invoiceAgent', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python312.zip', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/lib-dynload', '/Users/sailesh/Documents/GitHub/aiagent/venv/lib/python3.12/site-packages']
2025-02-04 20:39:13,218 - __main__ - DEBUG - Python version: 3.12.5 (v3.12.5:ff3bc82f7c9, Aug  7 2024, 05:32:06) [Clang 13.0.0 (clang-1300.0.29.30)]
2025-02-04 20:39:13,219 - __main__ - DEBUG - Python executable: /Users/sailesh/Documents/GitHub/aiagent/venv/bin/python3.12
2025-02-04 20:39:13,219 - __main__ - DEBUG - Current working directory: /Users/sailesh/Documents/GitHub/invoiceAgent
2025-02-04 20:39:13,219 - __main__ - DEBUG - PYTHONPATH: :/Users/sailesh/Documents/GitHub/invoiceAgent
2025-02-04 20:39:13,219 - __main__ - DEBUG - Sys.path: ['src/invoice_agent/ui/app.py', 'src/invoice_agent/ui', '/Users/sailesh/Documents/GitHub/aiagent/venv/bin', '/Users/sailesh/Documents/GitHub/invoiceAgent', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python312.zip', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/lib-dynload', '/Users/sailesh/Documents/GitHub/aiagent/venv/lib/python3.12/site-packages']
2025-02-04 20:39:13,220 - __main__ - DEBUG - Environment variables loaded
2025-02-04 20:39:13,220 - __main__ - DEBUG - Attempting to import invoice_agent modules...
2025-02-04 20:39:13,220 - __main__ - DEBUG - Importing invoice_agent modules...
2025-02-04 20:39:13,220 - __main__ - ERROR - Import error: No module named 'invoice_agent'
Traceback (most recent call last):
  File "/Users/sailesh/Documents/GitHub/invoiceAgent/src/invoice_agent/ui/app.py", line 53, in <module>
    from invoice_agent.core.invoice_processor import InvoiceAgent
ModuleNotFoundError: No module named 'invoice_agent'
2025-02-04 20:39:13,220 - __main__ - ERROR - Current sys.path: ['src/invoice_agent/ui/app.py', 'src/invoice_agent/ui', '/Users/sailesh/Documents/GitHub/aiagent/venv/bin', '/Users/sailesh/Documents/GitHub/invoiceAgent', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python312.zip', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/lib-dynload', '/Users/sailesh/Documents/GitHub/aiagent/venv/lib/python3.12/site-packages']
2025-02-04 20:41:12,894 - __main__ - DEBUG - Python version: 3.12.5 (v3.12.5:ff3bc82f7c9, Aug  7 2024, 05:32:06) [Clang 13.0.0 (clang-1300.0.29.30)]
2025-02-04 20:41:12,894 - __main__ - DEBUG - Python executable: /Users/sailesh/Documents/GitHub/aiagent/venv/bin/python3.12
2025-02-04 20:41:12,894 - __main__ - DEBUG - Current working directory: /Users/sailesh/Documents/GitHub/invoiceAgent
2025-02-04 20:41:12,894 - __main__ - DEBUG - PYTHONPATH: :/Users/sailesh/Documents/GitHub/invoiceAgent/src
2025-02-04 20:41:12,894 - __main__ - DEBUG - Sys.path: ['src/invoice_agent/ui/app.py', 'src/invoice_agent/ui', '/Users/sailesh/Documents/GitHub/aiagent/venv/bin', '/Users/sailesh/Documents/GitHub/invoiceAgent', '/Users/sailesh/Documents/GitHub/invoiceAgent/src', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python312.zip', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/lib-dynload', '/Users/sailesh/Documents/GitHub/aiagent/venv/lib/python3.12/site-packages']
2025-02-04 20:41:12,895 - __main__ - DEBUG - Environment variables loaded
2025-02-04 20:41:12,895 - __main__ - DEBUG - Attempting to import invoice_agent modules...
2025-02-04 20:41:12,896 - __main__ - DEBUG - Importing invoice_agent modules...
2025-02-04 20:41:15,555 - invoice_agent.security.auth - INFO - AuthManager initialized with redirect URI: http://localhost:8501
2025-02-04 20:41:15,555 - invoice_agent.security.auth - INFO - Using Streamlit port: 8501
2025-02-04 20:41:15,555 - invoice_agent.security.auth - DEBUG - Google Client ID configured: True
2025-02-04 20:41:15,555 - invoice_agent.security.auth - DEBUG - Google Client Secret configured: True
2025-02-04 20:41:15,574 - __main__ - DEBUG - Imported InvoiceAgent
2025-02-04 20:41:15,575 - __main__ - DEBUG - Imported config_loader
2025-02-04 20:41:15,575 - __main__ - DEBUG - Imported AuthManager
2025-02-04 20:41:15,575 - __main__ - DEBUG - Imported TemplateManager
2025-02-04 20:41:15,575 - __main__ - DEBUG - Imported WorkflowManager
2025-02-04 20:41:15,575 - __main__ - DEBUG - Imported MetricsManager
2025-02-04 20:41:15,575 - __main__ - DEBUG - Initializing AuthManager...
2025-02-04 20:41:15,575 - invoice_agent.security.auth - INFO - AuthManager initialized with redirect URI: http://localhost:8501
2025-02-04 20:41:15,575 - invoice_agent.security.auth - INFO - Using Streamlit port: 8501
2025-02-04 20:41:15,575 - invoice_agent.security.auth - DEBUG - Google Client ID configured: True
2025-02-04 20:41:15,575 - invoice_agent.security.auth - DEBUG - Google Client Secret configured: True
2025-02-04 20:41:15,575 - __main__ - DEBUG - AuthManager initialized successfully
2025-02-04 20:41:15,575 - __main__ - DEBUG - Initializing MetricsManager...
2025-02-04 20:41:15,575 - __main__ - DEBUG - MetricsManager initialized successfully
2025-02-04 20:41:15,575 - __main__ - DEBUG - Initializing InvoiceAgent...
2025-02-04 20:41:15,579 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): huggingface.co:443
2025-02-04 20:41:15,690 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-02-04 20:41:15,917 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-02-04 20:41:16,073 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/processor_config.json HTTP/1.1" 404 0
2025-02-04 20:41:16,605 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/chat_template.json HTTP/1.1" 404 0
2025-02-04 20:41:16,732 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-02-04 20:41:16,908 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/config.json HTTP/1.1" 200 0
2025-02-04 20:41:16,994 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/config.json HTTP/1.1" 200 0
2025-02-04 20:41:17,124 - __main__ - DEBUG - InvoiceAgent initialized successfully
2025-02-04 20:41:17,124 - __main__ - DEBUG - Initializing WorkflowManager...
2025-02-04 20:41:17,126 - __main__ - DEBUG - WorkflowManager initialized successfully
2025-02-04 20:41:17,126 - __main__ - DEBUG - Initializing TemplateManager...
2025-02-04 20:41:17,126 - __main__ - DEBUG - TemplateManager initialized successfully
2025-02-04 20:41:17,126 - __main__ - DEBUG - Server settings configured
2025-02-04 20:41:17,129 - __main__ - DEBUG - Starting main application
2025-02-04 20:41:17,129 - __main__ - DEBUG - Initial session state: {}
2025-02-04 20:41:17,130 - __main__ - DEBUG - Session state after initialization: {'authenticated': False, 'auth_flow_started': False, 'initialized': True, 'auth_error': None, 'user_info': None, 'last_activity': 1738719677.13022, 'connection_attempts': 0, 'page': 'Dashboard'}
2025-02-04 20:41:17,130 - __main__ - DEBUG - Checking for OAuth callback parameters
2025-02-04 20:41:17,130 - __main__ - DEBUG - Query parameters: {}
2025-02-04 20:41:17,130 - __main__ - DEBUG - User not authenticated, showing auth page
2025-02-04 20:41:17,130 - __main__ - DEBUG - Rendering authentication page
2025-02-04 20:41:17,130 - __main__ - DEBUG - Current session state: {'authenticated': False, 'auth_flow_started': False, 'initialized': True, 'auth_error': None, 'user_info': None, 'last_activity': 1738719677.13022, 'connection_attempts': 0, 'page': 'Dashboard'}
2025-02-04 20:41:17,131 - __main__ - DEBUG - Showing Google sign-in button
2025-02-04 20:41:17,133 - __main__ - DEBUG - Showing Microsoft sign-in button
2025-02-04 20:41:17,133 - __main__ - DEBUG - Showing Service Account sign-in form
2025-02-04 20:41:18,228 - __main__ - DEBUG - Python version: 3.12.5 (v3.12.5:ff3bc82f7c9, Aug  7 2024, 05:32:06) [Clang 13.0.0 (clang-1300.0.29.30)]
2025-02-04 20:41:18,229 - __main__ - DEBUG - Python executable: /Users/sailesh/Documents/GitHub/aiagent/venv/bin/python3.12
2025-02-04 20:41:18,230 - __main__ - DEBUG - Current working directory: /Users/sailesh/Documents/GitHub/invoiceAgent
2025-02-04 20:41:18,230 - __main__ - DEBUG - PYTHONPATH: :/Users/sailesh/Documents/GitHub/invoiceAgent/src
2025-02-04 20:41:18,230 - __main__ - DEBUG - Sys.path: ['src/invoice_agent/ui/app.py', 'src/invoice_agent/ui', '/Users/sailesh/Documents/GitHub/aiagent/venv/bin', '/Users/sailesh/Documents/GitHub/invoiceAgent', '/Users/sailesh/Documents/GitHub/invoiceAgent/src', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python312.zip', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/lib-dynload', '/Users/sailesh/Documents/GitHub/aiagent/venv/lib/python3.12/site-packages', '/var/folders/0c/vbd1lzvs6p35p66t1zm047sh0000gn/T/tmp70vstw9j']
2025-02-04 20:41:18,233 - __main__ - DEBUG - Environment variables loaded
2025-02-04 20:41:18,233 - __main__ - DEBUG - Attempting to import invoice_agent modules...
2025-02-04 20:41:18,233 - __main__ - DEBUG - Importing invoice_agent modules...
2025-02-04 20:41:18,233 - __main__ - DEBUG - Imported InvoiceAgent
2025-02-04 20:41:18,234 - __main__ - DEBUG - Imported config_loader
2025-02-04 20:41:18,234 - __main__ - DEBUG - Imported AuthManager
2025-02-04 20:41:18,234 - __main__ - DEBUG - Imported TemplateManager
2025-02-04 20:41:18,234 - __main__ - DEBUG - Imported WorkflowManager
2025-02-04 20:41:18,235 - __main__ - DEBUG - Imported MetricsManager
2025-02-04 20:41:18,235 - __main__ - DEBUG - Initializing AuthManager...
2025-02-04 20:41:18,235 - invoice_agent.security.auth - INFO - AuthManager initialized with redirect URI: http://localhost:8501
2025-02-04 20:41:18,235 - invoice_agent.security.auth - INFO - Using Streamlit port: 8501
2025-02-04 20:41:18,235 - invoice_agent.security.auth - DEBUG - Google Client ID configured: True
2025-02-04 20:41:18,235 - invoice_agent.security.auth - DEBUG - Google Client Secret configured: True
2025-02-04 20:41:18,236 - __main__ - DEBUG - AuthManager initialized successfully
2025-02-04 20:41:18,236 - __main__ - DEBUG - Initializing MetricsManager...
2025-02-04 20:41:18,236 - __main__ - DEBUG - MetricsManager initialized successfully
2025-02-04 20:41:18,236 - __main__ - DEBUG - Initializing InvoiceAgent...
2025-02-04 20:41:18,305 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-02-04 20:41:18,408 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-02-04 20:41:18,560 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/processor_config.json HTTP/1.1" 404 0
2025-02-04 20:41:18,626 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/chat_template.json HTTP/1.1" 404 0
2025-02-04 20:41:18,683 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-02-04 20:41:18,873 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/config.json HTTP/1.1" 200 0
2025-02-04 20:41:18,926 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/config.json HTTP/1.1" 200 0
2025-02-04 20:41:18,966 - __main__ - DEBUG - InvoiceAgent initialized successfully
2025-02-04 20:41:18,967 - __main__ - DEBUG - Initializing WorkflowManager...
2025-02-04 20:41:18,967 - __main__ - DEBUG - WorkflowManager initialized successfully
2025-02-04 20:41:18,967 - __main__ - DEBUG - Initializing TemplateManager...
2025-02-04 20:41:18,967 - __main__ - DEBUG - TemplateManager initialized successfully
2025-02-04 20:41:18,967 - __main__ - DEBUG - Server settings configured
2025-02-04 20:41:18,968 - __main__ - DEBUG - Starting main application
2025-02-04 20:41:18,968 - __main__ - DEBUG - Initial session state: {'authenticated': False, 'auth_flow_started': False, 'initialized': True, 'auth_error': None, 'google_signin': True, 'user_info': None, 'last_activity': 1738719677.13022, 'connection_attempts': 0, 'page': 'Dashboard'}
2025-02-04 20:41:18,968 - __main__ - DEBUG - Session state after initialization: {'authenticated': False, 'auth_flow_started': False, 'initialized': True, 'auth_error': None, 'google_signin': True, 'user_info': None, 'last_activity': 1738719678.968535, 'connection_attempts': 0, 'page': 'Dashboard'}
2025-02-04 20:41:18,968 - __main__ - DEBUG - Checking for OAuth callback parameters
2025-02-04 20:41:18,968 - __main__ - DEBUG - Query parameters: {}
2025-02-04 20:41:18,969 - __main__ - DEBUG - User not authenticated, showing auth page
2025-02-04 20:41:18,969 - __main__ - DEBUG - Rendering authentication page
2025-02-04 20:41:18,969 - __main__ - DEBUG - Current session state: {'authenticated': False, 'auth_flow_started': False, 'initialized': True, 'auth_error': None, 'google_signin': True, 'user_info': None, 'last_activity': 1738719678.968535, 'connection_attempts': 0, 'page': 'Dashboard'}
2025-02-04 20:41:18,970 - __main__ - DEBUG - Showing Google sign-in button
2025-02-04 20:41:18,970 - __main__ - INFO - Google sign-in button clicked
2025-02-04 20:41:18,970 - __main__ - DEBUG - Starting Google OAuth authentication flow
2025-02-04 20:41:18,970 - __main__ - DEBUG - Received query parameters: {}
2025-02-04 20:41:18,970 - __main__ - DEBUG - Auth code present: False
2025-02-04 20:41:18,970 - __main__ - DEBUG - State present: False
2025-02-04 20:41:18,970 - __main__ - DEBUG - Current session state: {'authenticated': False, 'auth_flow_started': False, 'initialized': True, 'auth_error': None, 'google_signin': True, 'user_info': None, 'last_activity': 1738719678.968535, 'connection_attempts': 0, 'page': 'Dashboard'}
2025-02-04 20:41:18,970 - __main__ - INFO - Initiating Google OAuth flow...
2025-02-04 20:41:18,970 - invoice_agent.security.auth - DEBUG - Generated new state token: L3iCdCIwpd...
2025-02-04 20:41:18,970 - invoice_agent.security.auth - DEBUG - Using redirect URI: http://localhost:8501
2025-02-04 20:41:18,970 - invoice_agent.security.auth - INFO - Generated auth URL with state token: L3iCdCIwpd...
2025-02-04 20:41:18,970 - invoice_agent.security.auth - DEBUG - Full auth URL: https://accounts.google.com/o/oauth2/v2/auth?client_id=183173833346-kmsle3f3phtd3f71jms96q3uvcoqv0vu.apps.googleusercontent.com&redirect_uri=http%3A%2F%2Flocalhost%3A8501&response_type=code&scope=openid+email+profile&access_type=offline&state=L3iCdCIwpdkbp2SXf8jXdN10wETZKXUEz3-MAymyifo&prompt=consent&include_granted_scopes=true
2025-02-04 20:41:18,970 - __main__ - DEBUG - Generated auth URL: https://accounts.google.com/o/oauth2/v2/auth?client_id=183173833346-kmsle3f3phtd3f71jms96q3uvcoqv0vu.apps.googleusercontent.com&redirect_uri=http%3A%2F%2Flocalhost%3A8501&response_type=code&scope=openid+email+profile&access_type=offline&state=L3iCdCIwpdkbp2SXf8jXdN10wETZKXUEz3-MAymyifo&prompt=consent&include_granted_scopes=true
2025-02-04 20:41:18,971 - __main__ - DEBUG - Auth flow started flag set to True
2025-02-04 20:41:18,971 - __main__ - DEBUG - Session state before redirect: {'authenticated': False, 'auth_flow_started': True, 'initialized': True, 'auth_error': None, 'google_signin': True, 'user_info': None, 'last_activity': 1738719678.968535, 'connection_attempts': 0, 'page': 'Dashboard'}
2025-02-04 20:41:18,971 - __main__ - INFO - Redirecting to Google OAuth consent screen...
2025-02-04 20:41:59,700 - __main__ - DEBUG - Python version: 3.12.5 (v3.12.5:ff3bc82f7c9, Aug  7 2024, 05:32:06) [Clang 13.0.0 (clang-1300.0.29.30)]
2025-02-04 20:41:59,701 - __main__ - DEBUG - Python executable: /Users/sailesh/Documents/GitHub/aiagent/venv/bin/python3.12
2025-02-04 20:41:59,701 - __main__ - DEBUG - Current working directory: /Users/sailesh/Documents/GitHub/invoiceAgent
2025-02-04 20:41:59,701 - __main__ - DEBUG - PYTHONPATH: :/Users/sailesh/Documents/GitHub/invoiceAgent/src
2025-02-04 20:41:59,701 - __main__ - DEBUG - Sys.path: ['src/invoice_agent/ui/app.py', 'src/invoice_agent/ui', '/Users/sailesh/Documents/GitHub/aiagent/venv/bin', '/Users/sailesh/Documents/GitHub/invoiceAgent', '/Users/sailesh/Documents/GitHub/invoiceAgent/src', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python312.zip', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/lib-dynload', '/Users/sailesh/Documents/GitHub/aiagent/venv/lib/python3.12/site-packages']
2025-02-04 20:41:59,702 - __main__ - DEBUG - Environment variables loaded
2025-02-04 20:41:59,702 - __main__ - DEBUG - Attempting to import invoice_agent modules...
2025-02-04 20:41:59,703 - __main__ - DEBUG - Importing invoice_agent modules...
2025-02-04 20:42:02,360 - invoice_agent.security.auth - INFO - AuthManager initialized with redirect URI: http://localhost:8501
2025-02-04 20:42:02,360 - invoice_agent.security.auth - INFO - Using Streamlit port: 8501
2025-02-04 20:42:02,360 - invoice_agent.security.auth - DEBUG - Google Client ID configured: True
2025-02-04 20:42:02,360 - invoice_agent.security.auth - DEBUG - Google Client Secret configured: True
2025-02-04 20:42:02,379 - __main__ - DEBUG - Imported InvoiceAgent
2025-02-04 20:42:02,379 - __main__ - DEBUG - Imported config_loader
2025-02-04 20:42:02,379 - __main__ - DEBUG - Imported AuthManager
2025-02-04 20:42:02,379 - __main__ - DEBUG - Imported TemplateManager
2025-02-04 20:42:02,379 - __main__ - DEBUG - Imported WorkflowManager
2025-02-04 20:42:02,379 - __main__ - DEBUG - Imported MetricsManager
2025-02-04 20:42:02,379 - __main__ - DEBUG - Initializing AuthManager...
2025-02-04 20:42:02,379 - invoice_agent.security.auth - INFO - AuthManager initialized with redirect URI: http://localhost:8501
2025-02-04 20:42:02,379 - invoice_agent.security.auth - INFO - Using Streamlit port: 8501
2025-02-04 20:42:02,379 - invoice_agent.security.auth - DEBUG - Google Client ID configured: True
2025-02-04 20:42:02,379 - invoice_agent.security.auth - DEBUG - Google Client Secret configured: True
2025-02-04 20:42:02,379 - __main__ - DEBUG - AuthManager initialized successfully
2025-02-04 20:42:02,379 - __main__ - DEBUG - Initializing MetricsManager...
2025-02-04 20:42:02,379 - __main__ - DEBUG - MetricsManager initialized successfully
2025-02-04 20:42:02,379 - __main__ - DEBUG - Initializing InvoiceAgent...
2025-02-04 20:42:02,382 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): huggingface.co:443
2025-02-04 20:42:02,539 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-02-04 20:42:02,627 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-02-04 20:42:02,777 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/processor_config.json HTTP/1.1" 404 0
2025-02-04 20:42:02,889 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/chat_template.json HTTP/1.1" 404 0
2025-02-04 20:42:02,960 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-02-04 20:42:03,145 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/config.json HTTP/1.1" 200 0
2025-02-04 20:42:03,222 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/config.json HTTP/1.1" 200 0
2025-02-04 20:42:03,333 - __main__ - DEBUG - InvoiceAgent initialized successfully
2025-02-04 20:42:03,333 - __main__ - DEBUG - Initializing WorkflowManager...
2025-02-04 20:42:03,335 - __main__ - DEBUG - WorkflowManager initialized successfully
2025-02-04 20:42:03,335 - __main__ - DEBUG - Initializing TemplateManager...
2025-02-04 20:42:03,335 - __main__ - DEBUG - TemplateManager initialized successfully
2025-02-04 20:42:03,335 - __main__ - DEBUG - Server settings configured
2025-02-04 20:42:03,337 - __main__ - DEBUG - Starting main application
2025-02-04 20:42:03,337 - __main__ - DEBUG - Initial session state: {}
2025-02-04 20:42:03,338 - __main__ - DEBUG - Session state after initialization: {'page': 'Dashboard', 'auth_flow_started': False, 'initialized': True, 'auth_error': None, 'user_info': None, 'authenticated': False, 'last_activity': 1738719723.337632, 'connection_attempts': 0}
2025-02-04 20:42:03,338 - __main__ - DEBUG - Checking for OAuth callback parameters
2025-02-04 20:42:03,338 - __main__ - DEBUG - Query parameters: {}
2025-02-04 20:42:03,338 - __main__ - DEBUG - User not authenticated, showing auth page
2025-02-04 20:42:03,338 - __main__ - DEBUG - Rendering authentication page
2025-02-04 20:42:03,338 - __main__ - DEBUG - Current session state: {'page': 'Dashboard', 'auth_flow_started': False, 'initialized': True, 'auth_error': None, 'user_info': None, 'authenticated': False, 'last_activity': 1738719723.337632, 'connection_attempts': 0}
2025-02-04 20:42:03,339 - __main__ - DEBUG - Showing Google sign-in button
2025-02-04 20:42:03,339 - __main__ - DEBUG - Showing Microsoft sign-in button
2025-02-04 20:42:03,339 - __main__ - DEBUG - Showing Service Account sign-in form
2025-02-04 20:42:04,691 - __main__ - DEBUG - Python version: 3.12.5 (v3.12.5:ff3bc82f7c9, Aug  7 2024, 05:32:06) [Clang 13.0.0 (clang-1300.0.29.30)]
2025-02-04 20:42:04,692 - __main__ - DEBUG - Python executable: /Users/sailesh/Documents/GitHub/aiagent/venv/bin/python3.12
2025-02-04 20:42:04,692 - __main__ - DEBUG - Current working directory: /Users/sailesh/Documents/GitHub/invoiceAgent
2025-02-04 20:42:04,692 - __main__ - DEBUG - PYTHONPATH: :/Users/sailesh/Documents/GitHub/invoiceAgent/src
2025-02-04 20:42:04,692 - __main__ - DEBUG - Sys.path: ['src/invoice_agent/ui/app.py', 'src/invoice_agent/ui', '/Users/sailesh/Documents/GitHub/aiagent/venv/bin', '/Users/sailesh/Documents/GitHub/invoiceAgent', '/Users/sailesh/Documents/GitHub/invoiceAgent/src', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python312.zip', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/lib-dynload', '/Users/sailesh/Documents/GitHub/aiagent/venv/lib/python3.12/site-packages', '/var/folders/0c/vbd1lzvs6p35p66t1zm047sh0000gn/T/tmpz5ebuv9i']
2025-02-04 20:42:04,696 - __main__ - DEBUG - Environment variables loaded
2025-02-04 20:42:04,696 - __main__ - DEBUG - Attempting to import invoice_agent modules...
2025-02-04 20:42:04,696 - __main__ - DEBUG - Importing invoice_agent modules...
2025-02-04 20:42:04,696 - __main__ - DEBUG - Imported InvoiceAgent
2025-02-04 20:42:04,696 - __main__ - DEBUG - Imported config_loader
2025-02-04 20:42:04,696 - __main__ - DEBUG - Imported AuthManager
2025-02-04 20:42:04,697 - __main__ - DEBUG - Imported TemplateManager
2025-02-04 20:42:04,697 - __main__ - DEBUG - Imported WorkflowManager
2025-02-04 20:42:04,697 - __main__ - DEBUG - Imported MetricsManager
2025-02-04 20:42:04,697 - __main__ - DEBUG - Initializing AuthManager...
2025-02-04 20:42:04,697 - invoice_agent.security.auth - INFO - AuthManager initialized with redirect URI: http://localhost:8501
2025-02-04 20:42:04,697 - invoice_agent.security.auth - INFO - Using Streamlit port: 8501
2025-02-04 20:42:04,697 - invoice_agent.security.auth - DEBUG - Google Client ID configured: True
2025-02-04 20:42:04,697 - invoice_agent.security.auth - DEBUG - Google Client Secret configured: True
2025-02-04 20:42:04,697 - __main__ - DEBUG - AuthManager initialized successfully
2025-02-04 20:42:04,698 - __main__ - DEBUG - Initializing MetricsManager...
2025-02-04 20:42:04,699 - __main__ - DEBUG - MetricsManager initialized successfully
2025-02-04 20:42:04,700 - __main__ - DEBUG - Initializing InvoiceAgent...
2025-02-04 20:42:04,753 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-02-04 20:42:04,809 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-02-04 20:42:04,949 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/processor_config.json HTTP/1.1" 404 0
2025-02-04 20:42:05,032 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/chat_template.json HTTP/1.1" 404 0
2025-02-04 20:42:05,086 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-02-04 20:42:05,250 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/config.json HTTP/1.1" 200 0
2025-02-04 20:42:05,319 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/config.json HTTP/1.1" 200 0
2025-02-04 20:42:05,354 - __main__ - DEBUG - InvoiceAgent initialized successfully
2025-02-04 20:42:05,354 - __main__ - DEBUG - Initializing WorkflowManager...
2025-02-04 20:42:05,355 - __main__ - DEBUG - WorkflowManager initialized successfully
2025-02-04 20:42:05,355 - __main__ - DEBUG - Initializing TemplateManager...
2025-02-04 20:42:05,355 - __main__ - DEBUG - TemplateManager initialized successfully
2025-02-04 20:42:05,355 - __main__ - DEBUG - Server settings configured
2025-02-04 20:42:05,355 - __main__ - DEBUG - Starting main application
2025-02-04 20:42:05,356 - __main__ - DEBUG - Initial session state: {'page': 'Dashboard', 'auth_flow_started': False, 'google_signin': True, 'initialized': True, 'user_info': None, 'authenticated': False, 'last_activity': 1738719723.337632, 'auth_error': None, 'connection_attempts': 0}
2025-02-04 20:42:05,356 - __main__ - DEBUG - Session state after initialization: {'page': 'Dashboard', 'auth_flow_started': False, 'google_signin': True, 'initialized': True, 'user_info': None, 'authenticated': False, 'last_activity': 1738719725.3562062, 'auth_error': None, 'connection_attempts': 0}
2025-02-04 20:42:05,356 - __main__ - DEBUG - Checking for OAuth callback parameters
2025-02-04 20:42:05,356 - __main__ - DEBUG - Query parameters: {}
2025-02-04 20:42:05,356 - __main__ - DEBUG - User not authenticated, showing auth page
2025-02-04 20:42:05,356 - __main__ - DEBUG - Rendering authentication page
2025-02-04 20:42:05,356 - __main__ - DEBUG - Current session state: {'page': 'Dashboard', 'auth_flow_started': False, 'google_signin': True, 'initialized': True, 'user_info': None, 'authenticated': False, 'last_activity': 1738719725.3562062, 'auth_error': None, 'connection_attempts': 0}
2025-02-04 20:42:05,358 - __main__ - DEBUG - Showing Google sign-in button
2025-02-04 20:42:05,359 - __main__ - INFO - Google sign-in button clicked
2025-02-04 20:42:05,359 - __main__ - DEBUG - Starting Google OAuth authentication flow
2025-02-04 20:42:05,359 - __main__ - DEBUG - Received query parameters: {}
2025-02-04 20:42:05,359 - __main__ - DEBUG - Auth code present: False
2025-02-04 20:42:05,360 - __main__ - DEBUG - State present: False
2025-02-04 20:42:05,360 - __main__ - DEBUG - Current session state: {'page': 'Dashboard', 'auth_flow_started': False, 'google_signin': True, 'initialized': True, 'user_info': None, 'authenticated': False, 'last_activity': 1738719725.3562062, 'auth_error': None, 'connection_attempts': 0}
2025-02-04 20:42:05,360 - __main__ - INFO - Initiating Google OAuth flow...
2025-02-04 20:42:05,360 - invoice_agent.security.auth - DEBUG - Generated new state token: rdt5ctPzVx...
2025-02-04 20:42:05,360 - invoice_agent.security.auth - DEBUG - Using redirect URI: http://localhost:8501
2025-02-04 20:42:05,360 - invoice_agent.security.auth - INFO - Generated auth URL with state token: rdt5ctPzVx...
2025-02-04 20:42:05,360 - invoice_agent.security.auth - DEBUG - Full auth URL: https://accounts.google.com/o/oauth2/v2/auth?client_id=183173833346-kmsle3f3phtd3f71jms96q3uvcoqv0vu.apps.googleusercontent.com&redirect_uri=http%3A%2F%2Flocalhost%3A8501&response_type=code&scope=openid+email+profile&access_type=offline&state=rdt5ctPzVxSK4f_df4KKv_kXMbetmrLWhyrLK6mqgqI&prompt=consent&include_granted_scopes=true
2025-02-04 20:42:05,360 - __main__ - DEBUG - Generated auth URL: https://accounts.google.com/o/oauth2/v2/auth?client_id=183173833346-kmsle3f3phtd3f71jms96q3uvcoqv0vu.apps.googleusercontent.com&redirect_uri=http%3A%2F%2Flocalhost%3A8501&response_type=code&scope=openid+email+profile&access_type=offline&state=rdt5ctPzVxSK4f_df4KKv_kXMbetmrLWhyrLK6mqgqI&prompt=consent&include_granted_scopes=true
2025-02-04 20:42:05,360 - __main__ - DEBUG - Auth flow started flag set to True
2025-02-04 20:42:05,361 - __main__ - DEBUG - Session state before redirect: {'page': 'Dashboard', 'auth_flow_started': True, 'google_signin': True, 'initialized': True, 'user_info': None, 'authenticated': False, 'last_activity': 1738719725.3562062, 'auth_error': None, 'connection_attempts': 0}
2025-02-04 20:42:05,361 - __main__ - INFO - Redirecting to Google OAuth consent screen...
2025-02-04 20:42:42,092 - __main__ - DEBUG - Python version: 3.12.5 (v3.12.5:ff3bc82f7c9, Aug  7 2024, 05:32:06) [Clang 13.0.0 (clang-1300.0.29.30)]
2025-02-04 20:42:42,092 - __main__ - DEBUG - Python executable: /Users/sailesh/Documents/GitHub/aiagent/venv/bin/python3.12
2025-02-04 20:42:42,092 - __main__ - DEBUG - Current working directory: /Users/sailesh/Documents/GitHub/invoiceAgent
2025-02-04 20:42:42,092 - __main__ - DEBUG - PYTHONPATH: :/Users/sailesh/Documents/GitHub/invoiceAgent/src
2025-02-04 20:42:42,092 - __main__ - DEBUG - Sys.path: ['src/invoice_agent/ui/app.py', 'src/invoice_agent/ui', '/Users/sailesh/Documents/GitHub/aiagent/venv/bin', '/Users/sailesh/Documents/GitHub/invoiceAgent', '/Users/sailesh/Documents/GitHub/invoiceAgent/src', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python312.zip', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/lib-dynload', '/Users/sailesh/Documents/GitHub/aiagent/venv/lib/python3.12/site-packages']
2025-02-04 20:42:42,094 - __main__ - DEBUG - Environment variables loaded
2025-02-04 20:42:42,094 - __main__ - DEBUG - Attempting to import invoice_agent modules...
2025-02-04 20:42:42,094 - __main__ - DEBUG - Importing invoice_agent modules...
2025-02-04 20:42:44,743 - invoice_agent.security.auth - INFO - AuthManager initialized with redirect URI: http://localhost:8501
2025-02-04 20:42:44,743 - invoice_agent.security.auth - INFO - Using Streamlit port: 8501
2025-02-04 20:42:44,743 - invoice_agent.security.auth - DEBUG - Google Client ID configured: True
2025-02-04 20:42:44,744 - invoice_agent.security.auth - DEBUG - Google Client Secret configured: True
2025-02-04 20:42:44,763 - __main__ - DEBUG - Imported InvoiceAgent
2025-02-04 20:42:44,764 - __main__ - DEBUG - Imported config_loader
2025-02-04 20:42:44,764 - __main__ - DEBUG - Imported AuthManager
2025-02-04 20:42:44,764 - __main__ - DEBUG - Imported TemplateManager
2025-02-04 20:42:44,764 - __main__ - DEBUG - Imported WorkflowManager
2025-02-04 20:42:44,764 - __main__ - DEBUG - Imported MetricsManager
2025-02-04 20:42:44,764 - __main__ - DEBUG - Initializing AuthManager...
2025-02-04 20:42:44,764 - invoice_agent.security.auth - INFO - AuthManager initialized with redirect URI: http://localhost:8501
2025-02-04 20:42:44,764 - invoice_agent.security.auth - INFO - Using Streamlit port: 8501
2025-02-04 20:42:44,764 - invoice_agent.security.auth - DEBUG - Google Client ID configured: True
2025-02-04 20:42:44,764 - invoice_agent.security.auth - DEBUG - Google Client Secret configured: True
2025-02-04 20:42:44,764 - __main__ - DEBUG - AuthManager initialized successfully
2025-02-04 20:42:44,764 - __main__ - DEBUG - Initializing MetricsManager...
2025-02-04 20:42:44,764 - __main__ - DEBUG - MetricsManager initialized successfully
2025-02-04 20:42:44,764 - __main__ - DEBUG - Initializing InvoiceAgent...
2025-02-04 20:42:44,767 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): huggingface.co:443
2025-02-04 20:42:44,959 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-02-04 20:42:45,032 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-02-04 20:42:45,182 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/processor_config.json HTTP/1.1" 404 0
2025-02-04 20:42:45,301 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/chat_template.json HTTP/1.1" 404 0
2025-02-04 20:42:45,365 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-02-04 20:42:45,611 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/config.json HTTP/1.1" 200 0
2025-02-04 20:42:45,704 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/config.json HTTP/1.1" 200 0
2025-02-04 20:42:45,835 - __main__ - DEBUG - InvoiceAgent initialized successfully
2025-02-04 20:42:45,835 - __main__ - DEBUG - Initializing WorkflowManager...
2025-02-04 20:42:45,836 - __main__ - DEBUG - WorkflowManager initialized successfully
2025-02-04 20:42:45,836 - __main__ - DEBUG - Initializing TemplateManager...
2025-02-04 20:42:45,836 - __main__ - DEBUG - TemplateManager initialized successfully
2025-02-04 20:42:45,836 - __main__ - DEBUG - Server settings configured
2025-02-04 20:42:45,838 - __main__ - DEBUG - Starting main application
2025-02-04 20:42:45,838 - __main__ - DEBUG - Initial session state: {}
2025-02-04 20:42:45,839 - __main__ - DEBUG - Session state after initialization: {'authenticated': False, 'auth_flow_started': False, 'page': 'Dashboard', 'initialized': True, 'auth_error': None, 'last_activity': 1738719765.838754, 'user_info': None, 'connection_attempts': 0}
2025-02-04 20:42:45,839 - __main__ - DEBUG - Checking for OAuth callback parameters
2025-02-04 20:42:45,839 - __main__ - DEBUG - Query parameters: {}
2025-02-04 20:42:45,839 - __main__ - DEBUG - User not authenticated, showing auth page
2025-02-04 20:42:45,839 - __main__ - DEBUG - Rendering authentication page
2025-02-04 20:42:45,839 - __main__ - DEBUG - Current session state: {'authenticated': False, 'auth_flow_started': False, 'page': 'Dashboard', 'initialized': True, 'auth_error': None, 'last_activity': 1738719765.838754, 'user_info': None, 'connection_attempts': 0}
2025-02-04 20:42:45,840 - __main__ - DEBUG - Showing Google sign-in button
2025-02-04 20:42:45,840 - __main__ - DEBUG - Showing Microsoft sign-in button
2025-02-04 20:42:45,840 - __main__ - DEBUG - Showing Service Account sign-in form
2025-02-04 20:42:47,040 - __main__ - DEBUG - Python version: 3.12.5 (v3.12.5:ff3bc82f7c9, Aug  7 2024, 05:32:06) [Clang 13.0.0 (clang-1300.0.29.30)]
2025-02-04 20:42:47,040 - __main__ - DEBUG - Python executable: /Users/sailesh/Documents/GitHub/aiagent/venv/bin/python3.12
2025-02-04 20:42:47,041 - __main__ - DEBUG - Current working directory: /Users/sailesh/Documents/GitHub/invoiceAgent
2025-02-04 20:42:47,041 - __main__ - DEBUG - PYTHONPATH: :/Users/sailesh/Documents/GitHub/invoiceAgent/src
2025-02-04 20:42:47,041 - __main__ - DEBUG - Sys.path: ['src/invoice_agent/ui/app.py', 'src/invoice_agent/ui', '/Users/sailesh/Documents/GitHub/aiagent/venv/bin', '/Users/sailesh/Documents/GitHub/invoiceAgent', '/Users/sailesh/Documents/GitHub/invoiceAgent/src', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python312.zip', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/lib-dynload', '/Users/sailesh/Documents/GitHub/aiagent/venv/lib/python3.12/site-packages', '/var/folders/0c/vbd1lzvs6p35p66t1zm047sh0000gn/T/tmpxzcimwt_']
2025-02-04 20:42:47,045 - __main__ - DEBUG - Environment variables loaded
2025-02-04 20:42:47,045 - __main__ - DEBUG - Attempting to import invoice_agent modules...
2025-02-04 20:42:47,045 - __main__ - DEBUG - Importing invoice_agent modules...
2025-02-04 20:42:47,045 - __main__ - DEBUG - Imported InvoiceAgent
2025-02-04 20:42:47,045 - __main__ - DEBUG - Imported config_loader
2025-02-04 20:42:47,045 - __main__ - DEBUG - Imported AuthManager
2025-02-04 20:42:47,046 - __main__ - DEBUG - Imported TemplateManager
2025-02-04 20:42:47,046 - __main__ - DEBUG - Imported WorkflowManager
2025-02-04 20:42:47,046 - __main__ - DEBUG - Imported MetricsManager
2025-02-04 20:42:47,046 - __main__ - DEBUG - Initializing AuthManager...
2025-02-04 20:42:47,047 - invoice_agent.security.auth - INFO - AuthManager initialized with redirect URI: http://localhost:8501
2025-02-04 20:42:47,047 - invoice_agent.security.auth - INFO - Using Streamlit port: 8501
2025-02-04 20:42:47,047 - invoice_agent.security.auth - DEBUG - Google Client ID configured: True
2025-02-04 20:42:47,047 - invoice_agent.security.auth - DEBUG - Google Client Secret configured: True
2025-02-04 20:42:47,047 - __main__ - DEBUG - AuthManager initialized successfully
2025-02-04 20:42:47,047 - __main__ - DEBUG - Initializing MetricsManager...
2025-02-04 20:42:47,047 - __main__ - DEBUG - MetricsManager initialized successfully
2025-02-04 20:42:47,047 - __main__ - DEBUG - Initializing InvoiceAgent...
2025-02-04 20:42:47,194 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-02-04 20:42:47,251 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-02-04 20:42:47,392 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/processor_config.json HTTP/1.1" 404 0
2025-02-04 20:42:47,466 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/chat_template.json HTTP/1.1" 404 0
2025-02-04 20:42:47,524 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-02-04 20:42:47,684 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/config.json HTTP/1.1" 200 0
2025-02-04 20:42:47,737 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/config.json HTTP/1.1" 200 0
2025-02-04 20:42:47,774 - __main__ - DEBUG - InvoiceAgent initialized successfully
2025-02-04 20:42:47,774 - __main__ - DEBUG - Initializing WorkflowManager...
2025-02-04 20:42:47,775 - __main__ - DEBUG - WorkflowManager initialized successfully
2025-02-04 20:42:47,775 - __main__ - DEBUG - Initializing TemplateManager...
2025-02-04 20:42:47,775 - __main__ - DEBUG - TemplateManager initialized successfully
2025-02-04 20:42:47,775 - __main__ - DEBUG - Server settings configured
2025-02-04 20:42:47,775 - __main__ - DEBUG - Starting main application
2025-02-04 20:42:47,776 - __main__ - DEBUG - Initial session state: {'authenticated': False, 'auth_flow_started': False, 'page': 'Dashboard', 'google_signin': True, 'initialized': True, 'auth_error': None, 'last_activity': 1738719765.838754, 'user_info': None, 'connection_attempts': 0}
2025-02-04 20:42:47,776 - __main__ - DEBUG - Session state after initialization: {'authenticated': False, 'auth_flow_started': False, 'page': 'Dashboard', 'google_signin': True, 'initialized': True, 'auth_error': None, 'last_activity': 1738719767.7761931, 'user_info': None, 'connection_attempts': 0}
2025-02-04 20:42:47,776 - __main__ - DEBUG - Checking for OAuth callback parameters
2025-02-04 20:42:47,776 - __main__ - DEBUG - Query parameters: {}
2025-02-04 20:42:47,776 - __main__ - DEBUG - User not authenticated, showing auth page
2025-02-04 20:42:47,776 - __main__ - DEBUG - Rendering authentication page
2025-02-04 20:42:47,776 - __main__ - DEBUG - Current session state: {'authenticated': False, 'auth_flow_started': False, 'page': 'Dashboard', 'google_signin': True, 'initialized': True, 'auth_error': None, 'last_activity': 1738719767.7761931, 'user_info': None, 'connection_attempts': 0}
2025-02-04 20:42:47,777 - __main__ - DEBUG - Showing Google sign-in button
2025-02-04 20:42:47,777 - __main__ - INFO - Google sign-in button clicked
2025-02-04 20:42:47,778 - __main__ - DEBUG - Starting Google OAuth authentication flow
2025-02-04 20:42:47,778 - __main__ - DEBUG - Received query parameters: {}
2025-02-04 20:42:47,778 - __main__ - DEBUG - Auth code present: False
2025-02-04 20:42:47,778 - __main__ - DEBUG - State present: False
2025-02-04 20:42:47,778 - __main__ - DEBUG - Current session state: {'authenticated': False, 'auth_flow_started': False, 'page': 'Dashboard', 'google_signin': True, 'initialized': True, 'auth_error': None, 'last_activity': 1738719767.7761931, 'user_info': None, 'connection_attempts': 0}
2025-02-04 20:42:47,778 - __main__ - INFO - Initiating Google OAuth flow...
2025-02-04 20:42:47,778 - invoice_agent.security.auth - DEBUG - Generated new state token: uYTP5xI3d_...
2025-02-04 20:42:47,778 - invoice_agent.security.auth - DEBUG - Using redirect URI: http://localhost:8501
2025-02-04 20:42:47,778 - invoice_agent.security.auth - INFO - Generated auth URL with state token: uYTP5xI3d_...
2025-02-04 20:42:47,778 - invoice_agent.security.auth - DEBUG - Full auth URL: https://accounts.google.com/o/oauth2/v2/auth?client_id=183173833346-kmsle3f3phtd3f71jms96q3uvcoqv0vu.apps.googleusercontent.com&redirect_uri=http%3A%2F%2Flocalhost%3A8501&response_type=code&scope=openid+email+profile&access_type=offline&state=uYTP5xI3d_aF3JQrXG1MgQlvAwlvHa_F0ixxV7vdJoo&prompt=consent&include_granted_scopes=true
2025-02-04 20:42:47,778 - __main__ - DEBUG - Generated auth URL: https://accounts.google.com/o/oauth2/v2/auth?client_id=183173833346-kmsle3f3phtd3f71jms96q3uvcoqv0vu.apps.googleusercontent.com&redirect_uri=http%3A%2F%2Flocalhost%3A8501&response_type=code&scope=openid+email+profile&access_type=offline&state=uYTP5xI3d_aF3JQrXG1MgQlvAwlvHa_F0ixxV7vdJoo&prompt=consent&include_granted_scopes=true
2025-02-04 20:42:47,778 - __main__ - DEBUG - Auth flow started flag set to True
2025-02-04 20:42:47,778 - __main__ - DEBUG - Session state before redirect: {'authenticated': False, 'auth_flow_started': True, 'page': 'Dashboard', 'google_signin': True, 'initialized': True, 'auth_error': None, 'last_activity': 1738719767.7761931, 'user_info': None, 'connection_attempts': 0}
2025-02-04 20:42:47,778 - __main__ - INFO - Redirecting to Google OAuth consent screen...
2025-02-04 20:43:06,064 - __main__ - DEBUG - Python version: 3.12.5 (v3.12.5:ff3bc82f7c9, Aug  7 2024, 05:32:06) [Clang 13.0.0 (clang-1300.0.29.30)]
2025-02-04 20:43:06,064 - __main__ - DEBUG - Python executable: /Users/sailesh/Documents/GitHub/aiagent/venv/bin/python3.12
2025-02-04 20:43:06,064 - __main__ - DEBUG - Current working directory: /Users/sailesh/Documents/GitHub/invoiceAgent
2025-02-04 20:43:06,064 - __main__ - DEBUG - PYTHONPATH: :/Users/sailesh/Documents/GitHub/invoiceAgent/src
2025-02-04 20:43:06,064 - __main__ - DEBUG - Sys.path: ['src/invoice_agent/ui/app.py', 'src/invoice_agent/ui', '/Users/sailesh/Documents/GitHub/aiagent/venv/bin', '/Users/sailesh/Documents/GitHub/invoiceAgent', '/Users/sailesh/Documents/GitHub/invoiceAgent/src', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python312.zip', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/lib-dynload', '/Users/sailesh/Documents/GitHub/aiagent/venv/lib/python3.12/site-packages']
2025-02-04 20:43:06,066 - __main__ - DEBUG - Environment variables loaded
2025-02-04 20:43:06,066 - __main__ - DEBUG - Attempting to import invoice_agent modules...
2025-02-04 20:43:06,066 - __main__ - DEBUG - Importing invoice_agent modules...
2025-02-04 20:43:08,497 - invoice_agent.security.auth - INFO - AuthManager initialized with redirect URI: http://localhost:8502
2025-02-04 20:43:08,497 - invoice_agent.security.auth - INFO - Using Streamlit port: 8502
2025-02-04 20:43:08,497 - invoice_agent.security.auth - DEBUG - Google Client ID configured: True
2025-02-04 20:43:08,498 - invoice_agent.security.auth - DEBUG - Google Client Secret configured: True
2025-02-04 20:43:08,517 - __main__ - DEBUG - Imported InvoiceAgent
2025-02-04 20:43:08,517 - __main__ - DEBUG - Imported config_loader
2025-02-04 20:43:08,517 - __main__ - DEBUG - Imported AuthManager
2025-02-04 20:43:08,517 - __main__ - DEBUG - Imported TemplateManager
2025-02-04 20:43:08,517 - __main__ - DEBUG - Imported WorkflowManager
2025-02-04 20:43:08,517 - __main__ - DEBUG - Imported MetricsManager
2025-02-04 20:43:08,517 - __main__ - DEBUG - Initializing AuthManager...
2025-02-04 20:43:08,517 - invoice_agent.security.auth - INFO - AuthManager initialized with redirect URI: http://localhost:8502
2025-02-04 20:43:08,517 - invoice_agent.security.auth - INFO - Using Streamlit port: 8502
2025-02-04 20:43:08,517 - invoice_agent.security.auth - DEBUG - Google Client ID configured: True
2025-02-04 20:43:08,517 - invoice_agent.security.auth - DEBUG - Google Client Secret configured: True
2025-02-04 20:43:08,517 - __main__ - DEBUG - AuthManager initialized successfully
2025-02-04 20:43:08,517 - __main__ - DEBUG - Initializing MetricsManager...
2025-02-04 20:43:08,517 - __main__ - DEBUG - MetricsManager initialized successfully
2025-02-04 20:43:08,517 - __main__ - DEBUG - Initializing InvoiceAgent...
2025-02-04 20:43:08,521 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): huggingface.co:443
2025-02-04 20:43:08,709 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-02-04 20:43:08,787 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-02-04 20:43:08,966 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/processor_config.json HTTP/1.1" 404 0
2025-02-04 20:43:09,026 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/chat_template.json HTTP/1.1" 404 0
2025-02-04 20:43:09,096 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-02-04 20:43:09,272 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/config.json HTTP/1.1" 200 0
2025-02-04 20:43:09,343 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/config.json HTTP/1.1" 200 0
2025-02-04 20:43:09,447 - __main__ - DEBUG - InvoiceAgent initialized successfully
2025-02-04 20:43:09,447 - __main__ - DEBUG - Initializing WorkflowManager...
2025-02-04 20:43:09,449 - __main__ - DEBUG - WorkflowManager initialized successfully
2025-02-04 20:43:09,449 - __main__ - DEBUG - Initializing TemplateManager...
2025-02-04 20:43:09,449 - __main__ - DEBUG - TemplateManager initialized successfully
2025-02-04 20:43:09,449 - __main__ - DEBUG - Server settings configured
2025-02-04 20:43:09,451 - __main__ - DEBUG - Starting main application
2025-02-04 20:43:09,451 - __main__ - DEBUG - Initial session state: {}
2025-02-04 20:43:09,452 - __main__ - DEBUG - Session state after initialization: {'auth_flow_started': False, 'initialized': True, 'authenticated': False, 'user_info': None, 'auth_error': None, 'last_activity': 1738719789.451964, 'page': 'Dashboard', 'connection_attempts': 0}
2025-02-04 20:43:09,452 - __main__ - DEBUG - Checking for OAuth callback parameters
2025-02-04 20:43:09,452 - __main__ - DEBUG - Query parameters: {}
2025-02-04 20:43:09,452 - __main__ - DEBUG - User not authenticated, showing auth page
2025-02-04 20:43:09,452 - __main__ - DEBUG - Rendering authentication page
2025-02-04 20:43:09,452 - __main__ - DEBUG - Current session state: {'auth_flow_started': False, 'initialized': True, 'authenticated': False, 'user_info': None, 'auth_error': None, 'last_activity': 1738719789.451964, 'page': 'Dashboard', 'connection_attempts': 0}
2025-02-04 20:43:09,454 - __main__ - DEBUG - Showing Google sign-in button
2025-02-04 20:43:09,454 - __main__ - DEBUG - Showing Microsoft sign-in button
2025-02-04 20:43:09,455 - __main__ - DEBUG - Showing Service Account sign-in form
2025-02-04 20:43:13,568 - __main__ - DEBUG - Python version: 3.12.5 (v3.12.5:ff3bc82f7c9, Aug  7 2024, 05:32:06) [Clang 13.0.0 (clang-1300.0.29.30)]
2025-02-04 20:43:13,569 - __main__ - DEBUG - Python executable: /Users/sailesh/Documents/GitHub/aiagent/venv/bin/python3.12
2025-02-04 20:43:13,570 - __main__ - DEBUG - Current working directory: /Users/sailesh/Documents/GitHub/invoiceAgent
2025-02-04 20:43:13,570 - __main__ - DEBUG - PYTHONPATH: :/Users/sailesh/Documents/GitHub/invoiceAgent/src
2025-02-04 20:43:13,570 - __main__ - DEBUG - Sys.path: ['src/invoice_agent/ui/app.py', 'src/invoice_agent/ui', '/Users/sailesh/Documents/GitHub/aiagent/venv/bin', '/Users/sailesh/Documents/GitHub/invoiceAgent', '/Users/sailesh/Documents/GitHub/invoiceAgent/src', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python312.zip', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/lib-dynload', '/Users/sailesh/Documents/GitHub/aiagent/venv/lib/python3.12/site-packages', '/var/folders/0c/vbd1lzvs6p35p66t1zm047sh0000gn/T/tmpuc9_8n7s']
2025-02-04 20:43:13,573 - __main__ - DEBUG - Environment variables loaded
2025-02-04 20:43:13,573 - __main__ - DEBUG - Attempting to import invoice_agent modules...
2025-02-04 20:43:13,574 - __main__ - DEBUG - Importing invoice_agent modules...
2025-02-04 20:43:13,574 - __main__ - DEBUG - Imported InvoiceAgent
2025-02-04 20:43:13,574 - __main__ - DEBUG - Imported config_loader
2025-02-04 20:43:13,575 - __main__ - DEBUG - Imported AuthManager
2025-02-04 20:43:13,575 - __main__ - DEBUG - Imported TemplateManager
2025-02-04 20:43:13,575 - __main__ - DEBUG - Imported WorkflowManager
2025-02-04 20:43:13,575 - __main__ - DEBUG - Imported MetricsManager
2025-02-04 20:43:13,575 - __main__ - DEBUG - Initializing AuthManager...
2025-02-04 20:43:13,576 - invoice_agent.security.auth - INFO - AuthManager initialized with redirect URI: http://localhost:8501
2025-02-04 20:43:13,576 - invoice_agent.security.auth - INFO - Using Streamlit port: 8501
2025-02-04 20:43:13,576 - invoice_agent.security.auth - DEBUG - Google Client ID configured: True
2025-02-04 20:43:13,576 - invoice_agent.security.auth - DEBUG - Google Client Secret configured: True
2025-02-04 20:43:13,577 - __main__ - DEBUG - AuthManager initialized successfully
2025-02-04 20:43:13,577 - __main__ - DEBUG - Initializing MetricsManager...
2025-02-04 20:43:13,578 - __main__ - DEBUG - MetricsManager initialized successfully
2025-02-04 20:43:13,578 - __main__ - DEBUG - Initializing InvoiceAgent...
2025-02-04 20:43:13,631 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-02-04 20:43:13,684 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-02-04 20:43:13,849 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/processor_config.json HTTP/1.1" 404 0
2025-02-04 20:43:13,909 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/chat_template.json HTTP/1.1" 404 0
2025-02-04 20:43:13,964 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-02-04 20:43:14,151 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/config.json HTTP/1.1" 200 0
2025-02-04 20:43:14,215 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/config.json HTTP/1.1" 200 0
2025-02-04 20:43:14,255 - __main__ - DEBUG - InvoiceAgent initialized successfully
2025-02-04 20:43:14,255 - __main__ - DEBUG - Initializing WorkflowManager...
2025-02-04 20:43:14,255 - __main__ - DEBUG - WorkflowManager initialized successfully
2025-02-04 20:43:14,255 - __main__ - DEBUG - Initializing TemplateManager...
2025-02-04 20:43:14,255 - __main__ - DEBUG - TemplateManager initialized successfully
2025-02-04 20:43:14,255 - __main__ - DEBUG - Server settings configured
2025-02-04 20:43:14,256 - __main__ - DEBUG - Starting main application
2025-02-04 20:43:14,256 - __main__ - DEBUG - Initial session state: {'auth_flow_started': False, 'initialized': True, 'authenticated': False, 'user_info': None, 'auth_error': None, 'last_activity': 1738719789.451964, 'page': 'Dashboard', 'connection_attempts': 0, 'google_signin': True}
2025-02-04 20:43:14,256 - __main__ - DEBUG - Session state after initialization: {'auth_flow_started': False, 'initialized': True, 'authenticated': False, 'user_info': None, 'auth_error': None, 'last_activity': 1738719794.256489, 'page': 'Dashboard', 'connection_attempts': 0, 'google_signin': True}
2025-02-04 20:43:14,256 - __main__ - DEBUG - Checking for OAuth callback parameters
2025-02-04 20:43:14,256 - __main__ - DEBUG - Query parameters: {}
2025-02-04 20:43:14,256 - __main__ - DEBUG - User not authenticated, showing auth page
2025-02-04 20:43:14,257 - __main__ - DEBUG - Rendering authentication page
2025-02-04 20:43:14,257 - __main__ - DEBUG - Current session state: {'auth_flow_started': False, 'initialized': True, 'authenticated': False, 'user_info': None, 'auth_error': None, 'last_activity': 1738719794.256489, 'page': 'Dashboard', 'connection_attempts': 0, 'google_signin': True}
2025-02-04 20:43:14,257 - __main__ - DEBUG - Showing Google sign-in button
2025-02-04 20:43:14,258 - __main__ - INFO - Google sign-in button clicked
2025-02-04 20:43:14,258 - __main__ - DEBUG - Starting Google OAuth authentication flow
2025-02-04 20:43:14,258 - __main__ - DEBUG - Received query parameters: {}
2025-02-04 20:43:14,258 - __main__ - DEBUG - Auth code present: False
2025-02-04 20:43:14,258 - __main__ - DEBUG - State present: False
2025-02-04 20:43:14,258 - __main__ - DEBUG - Current session state: {'auth_flow_started': False, 'initialized': True, 'authenticated': False, 'user_info': None, 'auth_error': None, 'last_activity': 1738719794.256489, 'page': 'Dashboard', 'connection_attempts': 0, 'google_signin': True}
2025-02-04 20:43:14,258 - __main__ - INFO - Initiating Google OAuth flow...
2025-02-04 20:43:14,258 - invoice_agent.security.auth - DEBUG - Generated new state token: DVUAyQvxW6...
2025-02-04 20:43:14,258 - invoice_agent.security.auth - DEBUG - Using redirect URI: http://localhost:8501
2025-02-04 20:43:14,258 - invoice_agent.security.auth - INFO - Generated auth URL with state token: DVUAyQvxW6...
2025-02-04 20:43:14,258 - invoice_agent.security.auth - DEBUG - Full auth URL: https://accounts.google.com/o/oauth2/v2/auth?client_id=183173833346-kmsle3f3phtd3f71jms96q3uvcoqv0vu.apps.googleusercontent.com&redirect_uri=http%3A%2F%2Flocalhost%3A8501&response_type=code&scope=openid+email+profile&access_type=offline&state=DVUAyQvxW6UVYB-ta7JfUmqSXoh9godh71s4UFPMT5I&prompt=consent&include_granted_scopes=true
2025-02-04 20:43:14,258 - __main__ - DEBUG - Generated auth URL: https://accounts.google.com/o/oauth2/v2/auth?client_id=183173833346-kmsle3f3phtd3f71jms96q3uvcoqv0vu.apps.googleusercontent.com&redirect_uri=http%3A%2F%2Flocalhost%3A8501&response_type=code&scope=openid+email+profile&access_type=offline&state=DVUAyQvxW6UVYB-ta7JfUmqSXoh9godh71s4UFPMT5I&prompt=consent&include_granted_scopes=true
2025-02-04 20:43:14,258 - __main__ - DEBUG - Auth flow started flag set to True
2025-02-04 20:43:14,258 - __main__ - DEBUG - Session state before redirect: {'auth_flow_started': True, 'initialized': True, 'authenticated': False, 'user_info': None, 'auth_error': None, 'last_activity': 1738719794.256489, 'page': 'Dashboard', 'connection_attempts': 0, 'google_signin': True}
2025-02-04 20:43:14,258 - __main__ - INFO - Redirecting to Google OAuth consent screen...
2025-02-04 20:43:20,274 - __main__ - DEBUG - Python version: 3.12.5 (v3.12.5:ff3bc82f7c9, Aug  7 2024, 05:32:06) [Clang 13.0.0 (clang-1300.0.29.30)]
2025-02-04 20:43:20,274 - __main__ - DEBUG - Python executable: /Users/sailesh/Documents/GitHub/aiagent/venv/bin/python3.12
2025-02-04 20:43:20,275 - __main__ - DEBUG - Current working directory: /Users/sailesh/Documents/GitHub/invoiceAgent
2025-02-04 20:43:20,275 - __main__ - DEBUG - PYTHONPATH: :/Users/sailesh/Documents/GitHub/invoiceAgent/src
2025-02-04 20:43:20,275 - __main__ - DEBUG - Sys.path: ['src/invoice_agent/ui/app.py', 'src/invoice_agent/ui', '/Users/sailesh/Documents/GitHub/aiagent/venv/bin', '/Users/sailesh/Documents/GitHub/invoiceAgent', '/Users/sailesh/Documents/GitHub/invoiceAgent/src', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python312.zip', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/lib-dynload', '/Users/sailesh/Documents/GitHub/aiagent/venv/lib/python3.12/site-packages', '/var/folders/0c/vbd1lzvs6p35p66t1zm047sh0000gn/T/tmpuc9_8n7s']
2025-02-04 20:43:20,279 - __main__ - DEBUG - Environment variables loaded
2025-02-04 20:43:20,279 - __main__ - DEBUG - Attempting to import invoice_agent modules...
2025-02-04 20:43:20,279 - __main__ - DEBUG - Importing invoice_agent modules...
2025-02-04 20:43:20,279 - __main__ - DEBUG - Imported InvoiceAgent
2025-02-04 20:43:20,280 - __main__ - DEBUG - Imported config_loader
2025-02-04 20:43:20,280 - __main__ - DEBUG - Imported AuthManager
2025-02-04 20:43:20,280 - __main__ - DEBUG - Imported TemplateManager
2025-02-04 20:43:20,281 - __main__ - DEBUG - Imported WorkflowManager
2025-02-04 20:43:20,281 - __main__ - DEBUG - Imported MetricsManager
2025-02-04 20:43:20,281 - __main__ - DEBUG - Initializing AuthManager...
2025-02-04 20:43:20,283 - invoice_agent.security.auth - INFO - AuthManager initialized with redirect URI: http://localhost:8501
2025-02-04 20:43:20,283 - invoice_agent.security.auth - INFO - Using Streamlit port: 8501
2025-02-04 20:43:20,283 - invoice_agent.security.auth - DEBUG - Google Client ID configured: True
2025-02-04 20:43:20,284 - invoice_agent.security.auth - DEBUG - Google Client Secret configured: True
2025-02-04 20:43:20,286 - __main__ - DEBUG - AuthManager initialized successfully
2025-02-04 20:43:20,286 - __main__ - DEBUG - Initializing MetricsManager...
2025-02-04 20:43:20,286 - __main__ - DEBUG - MetricsManager initialized successfully
2025-02-04 20:43:20,287 - __main__ - DEBUG - Initializing InvoiceAgent...
2025-02-04 20:43:20,476 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-02-04 20:43:20,572 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-02-04 20:43:20,720 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/processor_config.json HTTP/1.1" 404 0
2025-02-04 20:43:20,777 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/chat_template.json HTTP/1.1" 404 0
2025-02-04 20:43:20,839 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-02-04 20:43:21,001 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/config.json HTTP/1.1" 200 0
2025-02-04 20:43:21,057 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/config.json HTTP/1.1" 200 0
2025-02-04 20:43:21,095 - __main__ - DEBUG - InvoiceAgent initialized successfully
2025-02-04 20:43:21,095 - __main__ - DEBUG - Initializing WorkflowManager...
2025-02-04 20:43:21,095 - __main__ - DEBUG - WorkflowManager initialized successfully
2025-02-04 20:43:21,095 - __main__ - DEBUG - Initializing TemplateManager...
2025-02-04 20:43:21,095 - __main__ - DEBUG - TemplateManager initialized successfully
2025-02-04 20:43:21,095 - __main__ - DEBUG - Server settings configured
2025-02-04 20:43:21,096 - __main__ - DEBUG - Starting main application
2025-02-04 20:43:21,096 - __main__ - DEBUG - Initial session state: {'auth_flow_started': True, 'initialized': True, 'authenticated': False, 'user_info': None, 'auth_error': None, 'last_activity': 1738719794.256489, 'page': 'Dashboard', 'connection_attempts': 0, 'google_signin': True}
2025-02-04 20:43:21,096 - __main__ - DEBUG - Session state after initialization: {'auth_flow_started': True, 'initialized': True, 'authenticated': False, 'user_info': None, 'auth_error': None, 'last_activity': 1738719801.096383, 'page': 'Dashboard', 'connection_attempts': 0, 'google_signin': True}
2025-02-04 20:43:21,096 - __main__ - DEBUG - Checking for OAuth callback parameters
2025-02-04 20:43:21,096 - __main__ - DEBUG - Query parameters: {}
2025-02-04 20:43:21,096 - __main__ - DEBUG - User not authenticated, showing auth page
2025-02-04 20:43:21,096 - __main__ - DEBUG - Rendering authentication page
2025-02-04 20:43:21,097 - __main__ - DEBUG - Current session state: {'auth_flow_started': True, 'initialized': True, 'authenticated': False, 'user_info': None, 'auth_error': None, 'last_activity': 1738719801.096383, 'page': 'Dashboard', 'connection_attempts': 0, 'google_signin': True}
2025-02-04 20:43:21,097 - __main__ - DEBUG - Showing redirect message for Google sign-in
2025-02-04 20:43:21,098 - __main__ - DEBUG - Showing Microsoft sign-in button
2025-02-04 20:43:21,098 - __main__ - DEBUG - Showing Service Account sign-in form
2025-02-04 20:43:21,098 - __main__ - DEBUG - Auth flow in progress, showing loading messages
2025-02-04 20:43:52,057 - __main__ - DEBUG - Python version: 3.12.5 (v3.12.5:ff3bc82f7c9, Aug  7 2024, 05:32:06) [Clang 13.0.0 (clang-1300.0.29.30)]
2025-02-04 20:43:52,058 - __main__ - DEBUG - Python executable: /Users/sailesh/Documents/GitHub/aiagent/venv/bin/python3.12
2025-02-04 20:43:52,058 - __main__ - DEBUG - Current working directory: /Users/sailesh/Documents/GitHub/invoiceAgent
2025-02-04 20:43:52,058 - __main__ - DEBUG - PYTHONPATH: :/Users/sailesh/Documents/GitHub/invoiceAgent/src
2025-02-04 20:43:52,058 - __main__ - DEBUG - Sys.path: ['src/invoice_agent/ui/app.py', 'src/invoice_agent/ui', '/Users/sailesh/Documents/GitHub/aiagent/venv/bin', '/Users/sailesh/Documents/GitHub/invoiceAgent', '/Users/sailesh/Documents/GitHub/invoiceAgent/src', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python312.zip', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/lib-dynload', '/Users/sailesh/Documents/GitHub/aiagent/venv/lib/python3.12/site-packages']
2025-02-04 20:43:52,059 - __main__ - DEBUG - Environment variables loaded
2025-02-04 20:43:52,059 - __main__ - DEBUG - Attempting to import invoice_agent modules...
2025-02-04 20:43:52,059 - __main__ - DEBUG - Importing invoice_agent modules...
2025-02-04 20:43:54,673 - invoice_agent.security.auth - INFO - AuthManager initialized with redirect URI: http://localhost:8502
2025-02-04 20:43:54,674 - invoice_agent.security.auth - INFO - Using Streamlit port: 8502
2025-02-04 20:43:54,674 - invoice_agent.security.auth - DEBUG - Google Client ID configured: True
2025-02-04 20:43:54,674 - invoice_agent.security.auth - DEBUG - Google Client Secret configured: True
2025-02-04 20:43:54,693 - __main__ - DEBUG - Imported InvoiceAgent
2025-02-04 20:43:54,694 - __main__ - DEBUG - Imported config_loader
2025-02-04 20:43:54,694 - __main__ - DEBUG - Imported AuthManager
2025-02-04 20:43:54,694 - __main__ - DEBUG - Imported TemplateManager
2025-02-04 20:43:54,694 - __main__ - DEBUG - Imported WorkflowManager
2025-02-04 20:43:54,694 - __main__ - DEBUG - Imported MetricsManager
2025-02-04 20:43:54,694 - __main__ - DEBUG - Initializing AuthManager...
2025-02-04 20:43:54,694 - invoice_agent.security.auth - INFO - AuthManager initialized with redirect URI: http://localhost:8502
2025-02-04 20:43:54,694 - invoice_agent.security.auth - INFO - Using Streamlit port: 8502
2025-02-04 20:43:54,694 - invoice_agent.security.auth - DEBUG - Google Client ID configured: True
2025-02-04 20:43:54,694 - invoice_agent.security.auth - DEBUG - Google Client Secret configured: True
2025-02-04 20:43:54,694 - __main__ - DEBUG - AuthManager initialized successfully
2025-02-04 20:43:54,694 - __main__ - DEBUG - Initializing MetricsManager...
2025-02-04 20:43:54,694 - __main__ - DEBUG - MetricsManager initialized successfully
2025-02-04 20:43:54,694 - __main__ - DEBUG - Initializing InvoiceAgent...
2025-02-04 20:43:54,697 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): huggingface.co:443
2025-02-04 20:43:54,822 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-02-04 20:43:54,909 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-02-04 20:43:55,429 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/processor_config.json HTTP/1.1" 404 0
2025-02-04 20:43:55,497 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/chat_template.json HTTP/1.1" 404 0
2025-02-04 20:43:55,629 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-02-04 20:43:55,854 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/config.json HTTP/1.1" 200 0
2025-02-04 20:43:55,995 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/config.json HTTP/1.1" 200 0
2025-02-04 20:43:56,126 - __main__ - DEBUG - InvoiceAgent initialized successfully
2025-02-04 20:43:56,126 - __main__ - DEBUG - Initializing WorkflowManager...
2025-02-04 20:43:56,128 - __main__ - DEBUG - WorkflowManager initialized successfully
2025-02-04 20:43:56,128 - __main__ - DEBUG - Initializing TemplateManager...
2025-02-04 20:43:56,128 - __main__ - DEBUG - TemplateManager initialized successfully
2025-02-04 20:43:56,128 - __main__ - DEBUG - Server settings configured
2025-02-04 20:43:56,130 - __main__ - DEBUG - Starting main application
2025-02-04 20:43:56,130 - __main__ - DEBUG - Initial session state: {}
2025-02-04 20:43:56,131 - __main__ - DEBUG - Session state after initialization: {'page': 'Dashboard', 'auth_flow_started': False, 'initialized': True, 'auth_error': None, 'authenticated': False, 'connection_attempts': 0, 'user_info': None, 'last_activity': 1738719836.130765}
2025-02-04 20:43:56,131 - __main__ - DEBUG - Checking for OAuth callback parameters
2025-02-04 20:43:56,131 - __main__ - DEBUG - Query parameters: {}
2025-02-04 20:43:56,131 - __main__ - DEBUG - User not authenticated, showing auth page
2025-02-04 20:43:56,131 - __main__ - DEBUG - Rendering authentication page
2025-02-04 20:43:56,131 - __main__ - DEBUG - Current session state: {'page': 'Dashboard', 'auth_flow_started': False, 'initialized': True, 'auth_error': None, 'authenticated': False, 'connection_attempts': 0, 'user_info': None, 'last_activity': 1738719836.130765}
2025-02-04 20:43:56,132 - __main__ - DEBUG - Showing Google sign-in button
2025-02-04 20:43:56,133 - __main__ - DEBUG - Showing Microsoft sign-in button
2025-02-04 20:43:56,133 - __main__ - DEBUG - Showing Service Account sign-in form
2025-02-04 20:43:57,425 - __main__ - DEBUG - Python version: 3.12.5 (v3.12.5:ff3bc82f7c9, Aug  7 2024, 05:32:06) [Clang 13.0.0 (clang-1300.0.29.30)]
2025-02-04 20:43:57,426 - __main__ - DEBUG - Python executable: /Users/sailesh/Documents/GitHub/aiagent/venv/bin/python3.12
2025-02-04 20:43:57,427 - __main__ - DEBUG - Current working directory: /Users/sailesh/Documents/GitHub/invoiceAgent
2025-02-04 20:43:57,427 - __main__ - DEBUG - PYTHONPATH: :/Users/sailesh/Documents/GitHub/invoiceAgent/src
2025-02-04 20:43:57,427 - __main__ - DEBUG - Sys.path: ['src/invoice_agent/ui/app.py', 'src/invoice_agent/ui', '/Users/sailesh/Documents/GitHub/aiagent/venv/bin', '/Users/sailesh/Documents/GitHub/invoiceAgent', '/Users/sailesh/Documents/GitHub/invoiceAgent/src', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python312.zip', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/lib-dynload', '/Users/sailesh/Documents/GitHub/aiagent/venv/lib/python3.12/site-packages', '/var/folders/0c/vbd1lzvs6p35p66t1zm047sh0000gn/T/tmpjsxd5zw4']
2025-02-04 20:43:57,431 - __main__ - DEBUG - Environment variables loaded
2025-02-04 20:43:57,431 - __main__ - DEBUG - Attempting to import invoice_agent modules...
2025-02-04 20:43:57,432 - __main__ - DEBUG - Importing invoice_agent modules...
2025-02-04 20:43:57,432 - __main__ - DEBUG - Imported InvoiceAgent
2025-02-04 20:43:57,433 - __main__ - DEBUG - Imported config_loader
2025-02-04 20:43:57,434 - __main__ - DEBUG - Imported AuthManager
2025-02-04 20:43:57,434 - __main__ - DEBUG - Imported TemplateManager
2025-02-04 20:43:57,434 - __main__ - DEBUG - Imported WorkflowManager
2025-02-04 20:43:57,434 - __main__ - DEBUG - Imported MetricsManager
2025-02-04 20:43:57,434 - __main__ - DEBUG - Initializing AuthManager...
2025-02-04 20:43:57,434 - invoice_agent.security.auth - INFO - AuthManager initialized with redirect URI: http://localhost:8502
2025-02-04 20:43:57,434 - invoice_agent.security.auth - INFO - Using Streamlit port: 8502
2025-02-04 20:43:57,435 - invoice_agent.security.auth - DEBUG - Google Client ID configured: True
2025-02-04 20:43:57,435 - invoice_agent.security.auth - DEBUG - Google Client Secret configured: True
2025-02-04 20:43:57,435 - __main__ - DEBUG - AuthManager initialized successfully
2025-02-04 20:43:57,436 - __main__ - DEBUG - Initializing MetricsManager...
2025-02-04 20:43:57,437 - __main__ - DEBUG - MetricsManager initialized successfully
2025-02-04 20:43:57,437 - __main__ - DEBUG - Initializing InvoiceAgent...
2025-02-04 20:43:57,486 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-02-04 20:43:57,597 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-02-04 20:43:57,787 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/processor_config.json HTTP/1.1" 404 0
2025-02-04 20:43:57,855 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/chat_template.json HTTP/1.1" 404 0
2025-02-04 20:43:57,912 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-02-04 20:43:58,501 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/config.json HTTP/1.1" 200 0
2025-02-04 20:43:58,613 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/config.json HTTP/1.1" 200 0
2025-02-04 20:43:58,668 - __main__ - DEBUG - InvoiceAgent initialized successfully
2025-02-04 20:43:58,668 - __main__ - DEBUG - Initializing WorkflowManager...
2025-02-04 20:43:58,668 - __main__ - DEBUG - WorkflowManager initialized successfully
2025-02-04 20:43:58,668 - __main__ - DEBUG - Initializing TemplateManager...
2025-02-04 20:43:58,668 - __main__ - DEBUG - TemplateManager initialized successfully
2025-02-04 20:43:58,669 - __main__ - DEBUG - Server settings configured
2025-02-04 20:43:58,669 - __main__ - DEBUG - Starting main application
2025-02-04 20:43:58,669 - __main__ - DEBUG - Initial session state: {'page': 'Dashboard', 'initialized': True, 'auth_flow_started': False, 'auth_error': None, 'authenticated': False, 'connection_attempts': 0, 'google_signin': True, 'user_info': None, 'last_activity': 1738719836.130765}
2025-02-04 20:43:58,669 - __main__ - DEBUG - Session state after initialization: {'page': 'Dashboard', 'initialized': True, 'auth_flow_started': False, 'auth_error': None, 'authenticated': False, 'connection_attempts': 0, 'google_signin': True, 'user_info': None, 'last_activity': 1738719838.669696}
2025-02-04 20:43:58,669 - __main__ - DEBUG - Checking for OAuth callback parameters
2025-02-04 20:43:58,670 - __main__ - DEBUG - Query parameters: {}
2025-02-04 20:43:58,670 - __main__ - DEBUG - User not authenticated, showing auth page
2025-02-04 20:43:58,670 - __main__ - DEBUG - Rendering authentication page
2025-02-04 20:43:58,670 - __main__ - DEBUG - Current session state: {'page': 'Dashboard', 'initialized': True, 'auth_flow_started': False, 'auth_error': None, 'authenticated': False, 'connection_attempts': 0, 'google_signin': True, 'user_info': None, 'last_activity': 1738719838.669696}
2025-02-04 20:43:58,671 - __main__ - DEBUG - Showing Google sign-in button
2025-02-04 20:43:58,671 - __main__ - INFO - Google sign-in button clicked
2025-02-04 20:43:58,671 - __main__ - DEBUG - Starting Google OAuth authentication flow
2025-02-04 20:43:58,671 - __main__ - DEBUG - Received query parameters: {}
2025-02-04 20:43:58,671 - __main__ - DEBUG - Auth code present: False
2025-02-04 20:43:58,671 - __main__ - DEBUG - State present: False
2025-02-04 20:43:58,671 - __main__ - DEBUG - Current session state: {'page': 'Dashboard', 'initialized': True, 'auth_flow_started': False, 'auth_error': None, 'authenticated': False, 'connection_attempts': 0, 'google_signin': True, 'user_info': None, 'last_activity': 1738719838.669696}
2025-02-04 20:43:58,671 - __main__ - INFO - Initiating Google OAuth flow...
2025-02-04 20:43:58,671 - invoice_agent.security.auth - DEBUG - Generated new state token: htdhQuzTtj...
2025-02-04 20:43:58,671 - invoice_agent.security.auth - DEBUG - Using redirect URI: http://localhost:8502
2025-02-04 20:43:58,671 - invoice_agent.security.auth - INFO - Generated auth URL with state token: htdhQuzTtj...
2025-02-04 20:43:58,671 - invoice_agent.security.auth - DEBUG - Full auth URL: https://accounts.google.com/o/oauth2/v2/auth?client_id=183173833346-kmsle3f3phtd3f71jms96q3uvcoqv0vu.apps.googleusercontent.com&redirect_uri=http%3A%2F%2Flocalhost%3A8502&response_type=code&scope=openid+email+profile&access_type=offline&state=htdhQuzTtjYoLeWMtNRb6jnwzkv1msn99s-JbdsVLJE&prompt=consent&include_granted_scopes=true
2025-02-04 20:43:58,671 - __main__ - DEBUG - Generated auth URL: https://accounts.google.com/o/oauth2/v2/auth?client_id=183173833346-kmsle3f3phtd3f71jms96q3uvcoqv0vu.apps.googleusercontent.com&redirect_uri=http%3A%2F%2Flocalhost%3A8502&response_type=code&scope=openid+email+profile&access_type=offline&state=htdhQuzTtjYoLeWMtNRb6jnwzkv1msn99s-JbdsVLJE&prompt=consent&include_granted_scopes=true
2025-02-04 20:43:58,672 - __main__ - DEBUG - Auth flow started flag set to True
2025-02-04 20:43:58,672 - __main__ - DEBUG - Session state before redirect: {'page': 'Dashboard', 'initialized': True, 'auth_flow_started': True, 'auth_error': None, 'authenticated': False, 'connection_attempts': 0, 'google_signin': True, 'user_info': None, 'last_activity': 1738719838.669696}
2025-02-04 20:43:58,672 - __main__ - INFO - Redirecting to Google OAuth consent screen...
2025-02-04 20:46:58,538 - __main__ - DEBUG - Python version: 3.12.5 (v3.12.5:ff3bc82f7c9, Aug  7 2024, 05:32:06) [Clang 13.0.0 (clang-1300.0.29.30)]
2025-02-04 20:46:58,539 - __main__ - DEBUG - Python executable: /Users/sailesh/Documents/GitHub/aiagent/venv/bin/python3.12
2025-02-04 20:46:58,539 - __main__ - DEBUG - Current working directory: /Users/sailesh/Documents/GitHub/invoiceAgent
2025-02-04 20:46:58,539 - __main__ - DEBUG - PYTHONPATH: :/Users/sailesh/Documents/GitHub/invoiceAgent/src
2025-02-04 20:46:58,539 - __main__ - DEBUG - Sys.path: ['src/invoice_agent/ui/app.py', 'src/invoice_agent/ui', '/Users/sailesh/Documents/GitHub/aiagent/venv/bin', '/Users/sailesh/Documents/GitHub/invoiceAgent', '/Users/sailesh/Documents/GitHub/invoiceAgent/src', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python312.zip', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/lib-dynload', '/Users/sailesh/Documents/GitHub/aiagent/venv/lib/python3.12/site-packages']
2025-02-04 20:46:58,541 - __main__ - DEBUG - Environment variables loaded
2025-02-04 20:46:58,541 - __main__ - DEBUG - Attempting to import invoice_agent modules...
2025-02-04 20:46:58,541 - __main__ - DEBUG - Importing invoice_agent modules...
2025-02-04 20:47:01,311 - invoice_agent.security.auth - INFO - AuthManager initialized with redirect URI: http://localhost:8502
2025-02-04 20:47:01,311 - invoice_agent.security.auth - INFO - Using Streamlit port: 8502
2025-02-04 20:47:01,311 - invoice_agent.security.auth - DEBUG - Google Client ID configured: True
2025-02-04 20:47:01,311 - invoice_agent.security.auth - DEBUG - Google Client Secret configured: True
2025-02-04 20:47:01,335 - __main__ - DEBUG - Imported InvoiceAgent
2025-02-04 20:47:01,335 - __main__ - DEBUG - Imported config_loader
2025-02-04 20:47:01,335 - __main__ - DEBUG - Imported AuthManager
2025-02-04 20:47:01,335 - __main__ - DEBUG - Imported TemplateManager
2025-02-04 20:47:01,335 - __main__ - DEBUG - Imported WorkflowManager
2025-02-04 20:47:01,335 - __main__ - DEBUG - Imported MetricsManager
2025-02-04 20:47:01,335 - __main__ - DEBUG - Initializing AuthManager...
2025-02-04 20:47:01,335 - invoice_agent.security.auth - INFO - AuthManager initialized with redirect URI: http://localhost:8502
2025-02-04 20:47:01,335 - invoice_agent.security.auth - INFO - Using Streamlit port: 8502
2025-02-04 20:47:01,335 - invoice_agent.security.auth - DEBUG - Google Client ID configured: True
2025-02-04 20:47:01,335 - invoice_agent.security.auth - DEBUG - Google Client Secret configured: True
2025-02-04 20:47:01,336 - __main__ - DEBUG - AuthManager initialized successfully
2025-02-04 20:47:01,336 - __main__ - DEBUG - Initializing MetricsManager...
2025-02-04 20:47:01,336 - __main__ - DEBUG - MetricsManager initialized successfully
2025-02-04 20:47:01,336 - __main__ - DEBUG - Initializing InvoiceAgent...
2025-02-04 20:47:01,339 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): huggingface.co:443
2025-02-04 20:47:01,505 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-02-04 20:47:01,588 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-02-04 20:47:01,726 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/processor_config.json HTTP/1.1" 404 0
2025-02-04 20:47:01,798 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/chat_template.json HTTP/1.1" 404 0
2025-02-04 20:47:01,861 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-02-04 20:47:02,013 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/config.json HTTP/1.1" 200 0
2025-02-04 20:47:02,069 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/config.json HTTP/1.1" 200 0
2025-02-04 20:47:02,180 - __main__ - DEBUG - InvoiceAgent initialized successfully
2025-02-04 20:47:02,180 - __main__ - DEBUG - Initializing WorkflowManager...
2025-02-04 20:47:02,182 - __main__ - DEBUG - WorkflowManager initialized successfully
2025-02-04 20:47:02,182 - __main__ - DEBUG - Initializing TemplateManager...
2025-02-04 20:47:02,182 - __main__ - DEBUG - TemplateManager initialized successfully
2025-02-04 20:47:02,182 - __main__ - DEBUG - Server settings configured
2025-02-04 20:47:02,184 - __main__ - DEBUG - Starting main application
2025-02-04 20:47:02,184 - __main__ - DEBUG - Initial session state: {}
2025-02-04 20:47:02,185 - __main__ - DEBUG - Session state after initialization: {'user_info': None, 'connection_attempts': 0, 'initialized': True, 'page': 'Dashboard', 'authenticated': False, 'last_activity': 1738720022.184994, 'auth_flow_started': False, 'auth_error': None}
2025-02-04 20:47:02,185 - __main__ - DEBUG - Checking for OAuth callback parameters
2025-02-04 20:47:02,185 - __main__ - DEBUG - Query parameters: {}
2025-02-04 20:47:02,185 - __main__ - DEBUG - User not authenticated, showing auth page
2025-02-04 20:47:02,185 - __main__ - DEBUG - Rendering authentication page
2025-02-04 20:47:02,185 - __main__ - DEBUG - Current session state: {'user_info': None, 'connection_attempts': 0, 'initialized': True, 'page': 'Dashboard', 'authenticated': False, 'last_activity': 1738720022.184994, 'auth_flow_started': False, 'auth_error': None}
2025-02-04 20:47:02,186 - __main__ - DEBUG - Showing Google sign-in button
2025-02-04 20:47:02,187 - __main__ - DEBUG - Showing Microsoft sign-in button
2025-02-04 20:47:02,187 - __main__ - DEBUG - Showing Service Account sign-in form
2025-02-04 20:47:03,225 - __main__ - DEBUG - Python version: 3.12.5 (v3.12.5:ff3bc82f7c9, Aug  7 2024, 05:32:06) [Clang 13.0.0 (clang-1300.0.29.30)]
2025-02-04 20:47:03,226 - __main__ - DEBUG - Python executable: /Users/sailesh/Documents/GitHub/aiagent/venv/bin/python3.12
2025-02-04 20:47:03,226 - __main__ - DEBUG - Current working directory: /Users/sailesh/Documents/GitHub/invoiceAgent
2025-02-04 20:47:03,226 - __main__ - DEBUG - PYTHONPATH: :/Users/sailesh/Documents/GitHub/invoiceAgent/src
2025-02-04 20:47:03,226 - __main__ - DEBUG - Sys.path: ['src/invoice_agent/ui/app.py', 'src/invoice_agent/ui', '/Users/sailesh/Documents/GitHub/aiagent/venv/bin', '/Users/sailesh/Documents/GitHub/invoiceAgent', '/Users/sailesh/Documents/GitHub/invoiceAgent/src', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python312.zip', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/lib-dynload', '/Users/sailesh/Documents/GitHub/aiagent/venv/lib/python3.12/site-packages', '/var/folders/0c/vbd1lzvs6p35p66t1zm047sh0000gn/T/tmpzapseuad']
2025-02-04 20:47:03,228 - __main__ - DEBUG - Environment variables loaded
2025-02-04 20:47:03,229 - __main__ - DEBUG - Attempting to import invoice_agent modules...
2025-02-04 20:47:03,229 - __main__ - DEBUG - Importing invoice_agent modules...
2025-02-04 20:47:03,229 - __main__ - DEBUG - Imported InvoiceAgent
2025-02-04 20:47:03,229 - __main__ - DEBUG - Imported config_loader
2025-02-04 20:47:03,229 - __main__ - DEBUG - Imported AuthManager
2025-02-04 20:47:03,229 - __main__ - DEBUG - Imported TemplateManager
2025-02-04 20:47:03,229 - __main__ - DEBUG - Imported WorkflowManager
2025-02-04 20:47:03,229 - __main__ - DEBUG - Imported MetricsManager
2025-02-04 20:47:03,229 - __main__ - DEBUG - Initializing AuthManager...
2025-02-04 20:47:03,230 - invoice_agent.security.auth - INFO - AuthManager initialized with redirect URI: http://localhost:8502
2025-02-04 20:47:03,230 - invoice_agent.security.auth - INFO - Using Streamlit port: 8502
2025-02-04 20:47:03,230 - invoice_agent.security.auth - DEBUG - Google Client ID configured: True
2025-02-04 20:47:03,230 - invoice_agent.security.auth - DEBUG - Google Client Secret configured: True
2025-02-04 20:47:03,230 - __main__ - DEBUG - AuthManager initialized successfully
2025-02-04 20:47:03,230 - __main__ - DEBUG - Initializing MetricsManager...
2025-02-04 20:47:03,230 - __main__ - DEBUG - MetricsManager initialized successfully
2025-02-04 20:47:03,230 - __main__ - DEBUG - Initializing InvoiceAgent...
2025-02-04 20:47:03,291 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-02-04 20:47:03,344 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-02-04 20:47:03,511 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/processor_config.json HTTP/1.1" 404 0
2025-02-04 20:47:03,574 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/chat_template.json HTTP/1.1" 404 0
2025-02-04 20:47:03,653 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-02-04 20:47:03,829 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/config.json HTTP/1.1" 200 0
2025-02-04 20:47:03,885 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/config.json HTTP/1.1" 200 0
2025-02-04 20:47:03,924 - __main__ - DEBUG - InvoiceAgent initialized successfully
2025-02-04 20:47:03,924 - __main__ - DEBUG - Initializing WorkflowManager...
2025-02-04 20:47:03,925 - __main__ - DEBUG - WorkflowManager initialized successfully
2025-02-04 20:47:03,925 - __main__ - DEBUG - Initializing TemplateManager...
2025-02-04 20:47:03,925 - __main__ - DEBUG - TemplateManager initialized successfully
2025-02-04 20:47:03,925 - __main__ - DEBUG - Server settings configured
2025-02-04 20:47:03,925 - __main__ - DEBUG - Starting main application
2025-02-04 20:47:03,925 - __main__ - DEBUG - Initial session state: {'user_info': None, 'connection_attempts': 0, 'google_signin': True, 'initialized': True, 'page': 'Dashboard', 'authenticated': False, 'last_activity': 1738720022.184994, 'auth_flow_started': False, 'auth_error': None}
2025-02-04 20:47:03,926 - __main__ - DEBUG - Session state after initialization: {'user_info': None, 'connection_attempts': 0, 'google_signin': True, 'initialized': True, 'page': 'Dashboard', 'authenticated': False, 'last_activity': 1738720023.925952, 'auth_flow_started': False, 'auth_error': None}
2025-02-04 20:47:03,926 - __main__ - DEBUG - Checking for OAuth callback parameters
2025-02-04 20:47:03,926 - __main__ - DEBUG - Query parameters: {}
2025-02-04 20:47:03,926 - __main__ - DEBUG - User not authenticated, showing auth page
2025-02-04 20:47:03,926 - __main__ - DEBUG - Rendering authentication page
2025-02-04 20:47:03,926 - __main__ - DEBUG - Current session state: {'user_info': None, 'connection_attempts': 0, 'google_signin': True, 'initialized': True, 'page': 'Dashboard', 'authenticated': False, 'last_activity': 1738720023.925952, 'auth_flow_started': False, 'auth_error': None}
2025-02-04 20:47:03,927 - __main__ - DEBUG - Showing Google sign-in button
2025-02-04 20:47:03,927 - __main__ - INFO - Google sign-in button clicked
2025-02-04 20:47:03,927 - __main__ - DEBUG - Starting Google OAuth authentication flow
2025-02-04 20:47:03,927 - __main__ - DEBUG - Received query parameters: {}
2025-02-04 20:47:03,927 - __main__ - DEBUG - Auth code present: False
2025-02-04 20:47:03,927 - __main__ - DEBUG - State present: False
2025-02-04 20:47:03,927 - __main__ - DEBUG - Current session state: {'user_info': None, 'connection_attempts': 0, 'google_signin': True, 'initialized': True, 'page': 'Dashboard', 'authenticated': False, 'last_activity': 1738720023.925952, 'auth_flow_started': False, 'auth_error': None}
2025-02-04 20:47:03,927 - __main__ - INFO - Initiating Google OAuth flow...
2025-02-04 20:47:03,927 - invoice_agent.security.auth - DEBUG - Generated new state token: SaTPTmrUWA...
2025-02-04 20:47:03,927 - invoice_agent.security.auth - DEBUG - Using redirect URI: http://localhost:8502
2025-02-04 20:47:03,927 - invoice_agent.security.auth - INFO - Generated auth URL with state token: SaTPTmrUWA...
2025-02-04 20:47:03,927 - invoice_agent.security.auth - DEBUG - Full auth URL: https://accounts.google.com/o/oauth2/v2/auth?client_id=183173833346-kmsle3f3phtd3f71jms96q3uvcoqv0vu.apps.googleusercontent.com&redirect_uri=http%3A%2F%2Flocalhost%3A8502&response_type=code&scope=openid+email+profile&access_type=offline&state=SaTPTmrUWAZzIN6sPZMlecC-9CZPHQooVTj9F6R4tPg&prompt=consent&include_granted_scopes=true
2025-02-04 20:47:03,928 - __main__ - DEBUG - Generated auth URL: https://accounts.google.com/o/oauth2/v2/auth?client_id=183173833346-kmsle3f3phtd3f71jms96q3uvcoqv0vu.apps.googleusercontent.com&redirect_uri=http%3A%2F%2Flocalhost%3A8502&response_type=code&scope=openid+email+profile&access_type=offline&state=SaTPTmrUWAZzIN6sPZMlecC-9CZPHQooVTj9F6R4tPg&prompt=consent&include_granted_scopes=true
2025-02-04 20:47:03,928 - __main__ - DEBUG - Auth flow started flag set to True
2025-02-04 20:47:03,928 - __main__ - DEBUG - Session state before redirect: {'user_info': None, 'connection_attempts': 0, 'google_signin': True, 'initialized': True, 'page': 'Dashboard', 'authenticated': False, 'last_activity': 1738720023.925952, 'auth_flow_started': True, 'auth_error': None}
2025-02-04 20:47:03,928 - __main__ - INFO - Redirecting to Google OAuth consent screen...
2025-02-04 20:47:10,254 - __main__ - DEBUG - Python version: 3.12.5 (v3.12.5:ff3bc82f7c9, Aug  7 2024, 05:32:06) [Clang 13.0.0 (clang-1300.0.29.30)]
2025-02-04 20:47:10,254 - __main__ - DEBUG - Python executable: /Users/sailesh/Documents/GitHub/aiagent/venv/bin/python3.12
2025-02-04 20:47:10,254 - __main__ - DEBUG - Current working directory: /Users/sailesh/Documents/GitHub/invoiceAgent
2025-02-04 20:47:10,254 - __main__ - DEBUG - PYTHONPATH: :/Users/sailesh/Documents/GitHub/invoiceAgent/src
2025-02-04 20:47:10,254 - __main__ - DEBUG - Sys.path: ['src/invoice_agent/ui/app.py', 'src/invoice_agent/ui', '/Users/sailesh/Documents/GitHub/aiagent/venv/bin', '/Users/sailesh/Documents/GitHub/invoiceAgent', '/Users/sailesh/Documents/GitHub/invoiceAgent/src', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python312.zip', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/lib-dynload', '/Users/sailesh/Documents/GitHub/aiagent/venv/lib/python3.12/site-packages', '/var/folders/0c/vbd1lzvs6p35p66t1zm047sh0000gn/T/tmpzapseuad']
2025-02-04 20:47:10,256 - __main__ - DEBUG - Environment variables loaded
2025-02-04 20:47:10,256 - __main__ - DEBUG - Attempting to import invoice_agent modules...
2025-02-04 20:47:10,256 - __main__ - DEBUG - Importing invoice_agent modules...
2025-02-04 20:47:10,256 - __main__ - DEBUG - Imported InvoiceAgent
2025-02-04 20:47:10,256 - __main__ - DEBUG - Imported config_loader
2025-02-04 20:47:10,256 - __main__ - DEBUG - Imported AuthManager
2025-02-04 20:47:10,256 - __main__ - DEBUG - Imported TemplateManager
2025-02-04 20:47:10,256 - __main__ - DEBUG - Imported WorkflowManager
2025-02-04 20:47:10,256 - __main__ - DEBUG - Imported MetricsManager
2025-02-04 20:47:10,256 - __main__ - DEBUG - Initializing AuthManager...
2025-02-04 20:47:10,257 - invoice_agent.security.auth - INFO - AuthManager initialized with redirect URI: http://localhost:8502
2025-02-04 20:47:10,257 - invoice_agent.security.auth - INFO - Using Streamlit port: 8502
2025-02-04 20:47:10,257 - invoice_agent.security.auth - DEBUG - Google Client ID configured: True
2025-02-04 20:47:10,257 - invoice_agent.security.auth - DEBUG - Google Client Secret configured: True
2025-02-04 20:47:10,257 - __main__ - DEBUG - AuthManager initialized successfully
2025-02-04 20:47:10,257 - __main__ - DEBUG - Initializing MetricsManager...
2025-02-04 20:47:10,257 - __main__ - DEBUG - MetricsManager initialized successfully
2025-02-04 20:47:10,257 - __main__ - DEBUG - Initializing InvoiceAgent...
2025-02-04 20:47:10,315 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-02-04 20:47:10,403 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-02-04 20:47:10,543 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/processor_config.json HTTP/1.1" 404 0
2025-02-04 20:47:10,644 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/chat_template.json HTTP/1.1" 404 0
2025-02-04 20:47:10,701 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-02-04 20:47:10,862 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/config.json HTTP/1.1" 200 0
2025-02-04 20:47:10,917 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/config.json HTTP/1.1" 200 0
2025-02-04 20:47:10,956 - __main__ - DEBUG - InvoiceAgent initialized successfully
2025-02-04 20:47:10,956 - __main__ - DEBUG - Initializing WorkflowManager...
2025-02-04 20:47:10,957 - __main__ - DEBUG - WorkflowManager initialized successfully
2025-02-04 20:47:10,957 - __main__ - DEBUG - Initializing TemplateManager...
2025-02-04 20:47:10,957 - __main__ - DEBUG - TemplateManager initialized successfully
2025-02-04 20:47:10,957 - __main__ - DEBUG - Server settings configured
2025-02-04 20:47:10,957 - __main__ - DEBUG - Starting main application
2025-02-04 20:47:10,957 - __main__ - DEBUG - Initial session state: {}
2025-02-04 20:47:10,958 - __main__ - DEBUG - Session state after initialization: {'user_info': None, 'connection_attempts': 0, 'initialized': True, 'page': 'Dashboard', 'authenticated': False, 'last_activity': 1738720030.958177, 'auth_flow_started': False, 'auth_error': None}
2025-02-04 20:47:10,958 - __main__ - DEBUG - Checking for OAuth callback parameters
2025-02-04 20:47:10,958 - __main__ - DEBUG - Query parameters: {}
2025-02-04 20:47:10,958 - __main__ - DEBUG - User not authenticated, showing auth page
2025-02-04 20:47:10,959 - __main__ - DEBUG - Rendering authentication page
2025-02-04 20:47:10,960 - __main__ - DEBUG - Current session state: {'user_info': None, 'connection_attempts': 0, 'initialized': True, 'page': 'Dashboard', 'authenticated': False, 'last_activity': 1738720030.958177, 'auth_flow_started': False, 'auth_error': None}
2025-02-04 20:47:10,961 - __main__ - DEBUG - Showing Google sign-in button
2025-02-04 20:47:10,961 - __main__ - DEBUG - Showing Microsoft sign-in button
2025-02-04 20:47:10,961 - __main__ - DEBUG - Showing Service Account sign-in form
2025-02-04 20:47:13,074 - __main__ - DEBUG - Python version: 3.12.5 (v3.12.5:ff3bc82f7c9, Aug  7 2024, 05:32:06) [Clang 13.0.0 (clang-1300.0.29.30)]
2025-02-04 20:47:13,075 - __main__ - DEBUG - Python executable: /Users/sailesh/Documents/GitHub/aiagent/venv/bin/python3.12
2025-02-04 20:47:13,075 - __main__ - DEBUG - Current working directory: /Users/sailesh/Documents/GitHub/invoiceAgent
2025-02-04 20:47:13,075 - __main__ - DEBUG - PYTHONPATH: :/Users/sailesh/Documents/GitHub/invoiceAgent/src
2025-02-04 20:47:13,075 - __main__ - DEBUG - Sys.path: ['src/invoice_agent/ui/app.py', 'src/invoice_agent/ui', '/Users/sailesh/Documents/GitHub/aiagent/venv/bin', '/Users/sailesh/Documents/GitHub/invoiceAgent', '/Users/sailesh/Documents/GitHub/invoiceAgent/src', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python312.zip', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/lib-dynload', '/Users/sailesh/Documents/GitHub/aiagent/venv/lib/python3.12/site-packages', '/var/folders/0c/vbd1lzvs6p35p66t1zm047sh0000gn/T/tmpzapseuad']
2025-02-04 20:47:13,077 - __main__ - DEBUG - Environment variables loaded
2025-02-04 20:47:13,077 - __main__ - DEBUG - Attempting to import invoice_agent modules...
2025-02-04 20:47:13,077 - __main__ - DEBUG - Importing invoice_agent modules...
2025-02-04 20:47:13,077 - __main__ - DEBUG - Imported InvoiceAgent
2025-02-04 20:47:13,078 - __main__ - DEBUG - Imported config_loader
2025-02-04 20:47:13,078 - __main__ - DEBUG - Imported AuthManager
2025-02-04 20:47:13,078 - __main__ - DEBUG - Imported TemplateManager
2025-02-04 20:47:13,078 - __main__ - DEBUG - Imported WorkflowManager
2025-02-04 20:47:13,078 - __main__ - DEBUG - Imported MetricsManager
2025-02-04 20:47:13,078 - __main__ - DEBUG - Initializing AuthManager...
2025-02-04 20:47:13,078 - invoice_agent.security.auth - INFO - AuthManager initialized with redirect URI: http://localhost:8502
2025-02-04 20:47:13,078 - invoice_agent.security.auth - INFO - Using Streamlit port: 8502
2025-02-04 20:47:13,078 - invoice_agent.security.auth - DEBUG - Google Client ID configured: True
2025-02-04 20:47:13,078 - invoice_agent.security.auth - DEBUG - Google Client Secret configured: True
2025-02-04 20:47:13,078 - __main__ - DEBUG - AuthManager initialized successfully
2025-02-04 20:47:13,078 - __main__ - DEBUG - Initializing MetricsManager...
2025-02-04 20:47:13,078 - __main__ - DEBUG - MetricsManager initialized successfully
2025-02-04 20:47:13,078 - __main__ - DEBUG - Initializing InvoiceAgent...
2025-02-04 20:47:13,128 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-02-04 20:47:13,234 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-02-04 20:47:13,401 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/processor_config.json HTTP/1.1" 404 0
2025-02-04 20:47:13,522 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/chat_template.json HTTP/1.1" 404 0
2025-02-04 20:47:13,578 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-02-04 20:47:13,740 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/config.json HTTP/1.1" 200 0
2025-02-04 20:47:13,806 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/config.json HTTP/1.1" 200 0
2025-02-04 20:47:13,845 - __main__ - DEBUG - InvoiceAgent initialized successfully
2025-02-04 20:47:13,845 - __main__ - DEBUG - Initializing WorkflowManager...
2025-02-04 20:47:13,846 - __main__ - DEBUG - WorkflowManager initialized successfully
2025-02-04 20:47:13,846 - __main__ - DEBUG - Initializing TemplateManager...
2025-02-04 20:47:13,846 - __main__ - DEBUG - TemplateManager initialized successfully
2025-02-04 20:47:13,846 - __main__ - DEBUG - Server settings configured
2025-02-04 20:47:13,846 - __main__ - DEBUG - Starting main application
2025-02-04 20:47:13,846 - __main__ - DEBUG - Initial session state: {}
2025-02-04 20:47:13,847 - __main__ - DEBUG - Session state after initialization: {'user_info': None, 'connection_attempts': 0, 'initialized': True, 'page': 'Dashboard', 'authenticated': False, 'last_activity': 1738720033.847252, 'auth_flow_started': False, 'auth_error': None}
2025-02-04 20:47:13,847 - __main__ - DEBUG - Checking for OAuth callback parameters
2025-02-04 20:47:13,847 - __main__ - DEBUG - Query parameters: {'state': ['SaTPTmrUWAZzIN6sPZMlecC-9CZPHQooVTj9F6R4tPg'], 'code': ['4/0ASVgi3IkG9gr_a_sH108oTRDmwDzxLJ9RgICoSlxW44-mEXszMy9NzXd6ZA0rpSROhJb_A'], 'scope': ['email profile openid https://www.googleapis.com/auth/calendar.events https://www.googleapis.com/auth/calendar https://www.googleapis.com/auth/userinfo.profile https://www.googleapis.com/auth/userinfo.email'], 'authuser': ['0'], 'prompt': ['consent']}
2025-02-04 20:47:13,847 - __main__ - INFO - OAuth callback detected with code
2025-02-04 20:47:13,847 - __main__ - DEBUG - Starting Google OAuth authentication flow
2025-02-04 20:47:13,848 - __main__ - DEBUG - Received query parameters: {'state': ['SaTPTmrUWAZzIN6sPZMlecC-9CZPHQooVTj9F6R4tPg'], 'code': ['4/0ASVgi3IkG9gr_a_sH108oTRDmwDzxLJ9RgICoSlxW44-mEXszMy9NzXd6ZA0rpSROhJb_A'], 'scope': ['email profile openid https://www.googleapis.com/auth/calendar.events https://www.googleapis.com/auth/calendar https://www.googleapis.com/auth/userinfo.profile https://www.googleapis.com/auth/userinfo.email'], 'authuser': ['0'], 'prompt': ['consent']}
2025-02-04 20:47:13,848 - __main__ - DEBUG - Auth code present: True
2025-02-04 20:47:13,848 - __main__ - DEBUG - State present: True
2025-02-04 20:47:13,848 - __main__ - DEBUG - Current session state: {'user_info': None, 'connection_attempts': 0, 'initialized': True, 'page': 'Dashboard', 'authenticated': False, 'last_activity': 1738720033.847252, 'auth_flow_started': False, 'auth_error': None}
2025-02-04 20:47:13,848 - __main__ - INFO - Received auth code: 4/0ASVgi3I...
2025-02-04 20:47:13,848 - invoice_agent.security.auth - DEBUG - Received query parameters: {}
2025-02-04 20:47:13,848 - invoice_agent.security.auth - WARNING - Missing code or state in query parameters
2025-02-04 20:47:13,848 - __main__ - DEBUG - Auth result received: False
2025-02-04 20:47:13,848 - __main__ - ERROR - Authentication failed - auth_result is None
2025-02-04 20:50:26,356 - __main__ - DEBUG - Python version: 3.12.5 (v3.12.5:ff3bc82f7c9, Aug  7 2024, 05:32:06) [Clang 13.0.0 (clang-1300.0.29.30)]
2025-02-04 20:50:26,357 - __main__ - DEBUG - Python executable: /Users/sailesh/Documents/GitHub/aiagent/venv/bin/python3.12
2025-02-04 20:50:26,357 - __main__ - DEBUG - Current working directory: /Users/sailesh/Documents/GitHub/invoiceAgent
2025-02-04 20:50:26,357 - __main__ - DEBUG - PYTHONPATH: :/Users/sailesh/Documents/GitHub/invoiceAgent/src
2025-02-04 20:50:26,357 - __main__ - DEBUG - Sys.path: ['src/invoice_agent/ui/app.py', 'src/invoice_agent/ui', '/Users/sailesh/Documents/GitHub/aiagent/venv/bin', '/Users/sailesh/Documents/GitHub/invoiceAgent', '/Users/sailesh/Documents/GitHub/invoiceAgent/src', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python312.zip', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/lib-dynload', '/Users/sailesh/Documents/GitHub/aiagent/venv/lib/python3.12/site-packages']
2025-02-04 20:50:26,361 - __main__ - DEBUG - Environment variables loaded
2025-02-04 20:50:26,361 - __main__ - DEBUG - Attempting to import invoice_agent modules...
2025-02-04 20:50:26,361 - __main__ - DEBUG - Importing invoice_agent modules...
2025-02-04 20:50:29,261 - invoice_agent.security.auth - INFO - AuthManager initialized with redirect URI: http://localhost:8502
2025-02-04 20:50:29,261 - invoice_agent.security.auth - INFO - Using Streamlit port: 8502
2025-02-04 20:50:29,261 - invoice_agent.security.auth - DEBUG - Google Client ID configured: True
2025-02-04 20:50:29,261 - invoice_agent.security.auth - DEBUG - Google Client Secret configured: True
2025-02-04 20:50:29,285 - __main__ - DEBUG - Imported InvoiceAgent
2025-02-04 20:50:29,285 - __main__ - DEBUG - Imported config_loader
2025-02-04 20:50:29,285 - __main__ - DEBUG - Imported AuthManager
2025-02-04 20:50:29,285 - __main__ - DEBUG - Imported TemplateManager
2025-02-04 20:50:29,285 - __main__ - DEBUG - Imported WorkflowManager
2025-02-04 20:50:29,285 - __main__ - DEBUG - Imported MetricsManager
2025-02-04 20:50:29,285 - __main__ - DEBUG - Initializing AuthManager...
2025-02-04 20:50:29,286 - invoice_agent.security.auth - INFO - AuthManager initialized with redirect URI: http://localhost:8502
2025-02-04 20:50:29,286 - invoice_agent.security.auth - INFO - Using Streamlit port: 8502
2025-02-04 20:50:29,286 - invoice_agent.security.auth - DEBUG - Google Client ID configured: True
2025-02-04 20:50:29,286 - invoice_agent.security.auth - DEBUG - Google Client Secret configured: True
2025-02-04 20:50:29,286 - __main__ - DEBUG - AuthManager initialized successfully
2025-02-04 20:50:29,286 - __main__ - DEBUG - Initializing MetricsManager...
2025-02-04 20:50:29,286 - __main__ - DEBUG - MetricsManager initialized successfully
2025-02-04 20:50:29,286 - __main__ - DEBUG - Initializing InvoiceAgent...
2025-02-04 20:50:29,289 - urllib3.connectionpool - DEBUG - Starting new HTTPS connection (1): huggingface.co:443
2025-02-04 20:50:29,409 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-02-04 20:50:29,481 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-02-04 20:50:29,686 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/processor_config.json HTTP/1.1" 404 0
2025-02-04 20:50:29,741 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/chat_template.json HTTP/1.1" 404 0
2025-02-04 20:50:29,823 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-02-04 20:50:29,981 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/config.json HTTP/1.1" 200 0
2025-02-04 20:50:30,084 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/config.json HTTP/1.1" 200 0
2025-02-04 20:50:30,202 - __main__ - DEBUG - InvoiceAgent initialized successfully
2025-02-04 20:50:30,202 - __main__ - DEBUG - Initializing WorkflowManager...
2025-02-04 20:50:30,205 - __main__ - DEBUG - WorkflowManager initialized successfully
2025-02-04 20:50:30,205 - __main__ - DEBUG - Initializing TemplateManager...
2025-02-04 20:50:30,205 - __main__ - DEBUG - TemplateManager initialized successfully
2025-02-04 20:50:30,205 - __main__ - DEBUG - Server settings configured
2025-02-04 20:50:30,207 - __main__ - DEBUG - Starting main application
2025-02-04 20:50:30,208 - __main__ - DEBUG - Initial session state: {}
2025-02-04 20:50:30,209 - __main__ - DEBUG - Session state after initialization: {'page': 'Dashboard', 'auth_flow_started': False, 'initialized': True, 'last_activity': 1738720230.208431, 'auth_error': None, 'authenticated': False, 'user_info': None, 'connection_attempts': 0}
2025-02-04 20:50:30,209 - __main__ - DEBUG - Checking for OAuth callback parameters
2025-02-04 20:50:30,209 - __main__ - DEBUG - Query parameters: {}
2025-02-04 20:50:30,209 - __main__ - DEBUG - User not authenticated, showing auth page
2025-02-04 20:50:30,209 - __main__ - DEBUG - Rendering authentication page
2025-02-04 20:50:30,209 - __main__ - DEBUG - Current session state: {'page': 'Dashboard', 'auth_flow_started': False, 'initialized': True, 'last_activity': 1738720230.208431, 'auth_error': None, 'authenticated': False, 'user_info': None, 'connection_attempts': 0}
2025-02-04 20:50:30,210 - __main__ - DEBUG - Showing Google sign-in button
2025-02-04 20:50:30,210 - __main__ - DEBUG - Showing Microsoft sign-in button
2025-02-04 20:50:30,210 - __main__ - DEBUG - Showing Service Account sign-in form
2025-02-04 20:50:32,258 - __main__ - DEBUG - Python version: 3.12.5 (v3.12.5:ff3bc82f7c9, Aug  7 2024, 05:32:06) [Clang 13.0.0 (clang-1300.0.29.30)]
2025-02-04 20:50:32,261 - __main__ - DEBUG - Python executable: /Users/sailesh/Documents/GitHub/aiagent/venv/bin/python3.12
2025-02-04 20:50:32,261 - __main__ - DEBUG - Current working directory: /Users/sailesh/Documents/GitHub/invoiceAgent
2025-02-04 20:50:32,262 - __main__ - DEBUG - PYTHONPATH: :/Users/sailesh/Documents/GitHub/invoiceAgent/src
2025-02-04 20:50:32,262 - __main__ - DEBUG - Sys.path: ['src/invoice_agent/ui/app.py', 'src/invoice_agent/ui', '/Users/sailesh/Documents/GitHub/aiagent/venv/bin', '/Users/sailesh/Documents/GitHub/invoiceAgent', '/Users/sailesh/Documents/GitHub/invoiceAgent/src', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python312.zip', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/lib-dynload', '/Users/sailesh/Documents/GitHub/aiagent/venv/lib/python3.12/site-packages', '/var/folders/0c/vbd1lzvs6p35p66t1zm047sh0000gn/T/tmpnpxo44ed']
2025-02-04 20:50:32,267 - __main__ - DEBUG - Environment variables loaded
2025-02-04 20:50:32,267 - __main__ - DEBUG - Attempting to import invoice_agent modules...
2025-02-04 20:50:32,268 - __main__ - DEBUG - Importing invoice_agent modules...
2025-02-04 20:50:32,269 - __main__ - DEBUG - Imported InvoiceAgent
2025-02-04 20:50:32,269 - __main__ - DEBUG - Imported config_loader
2025-02-04 20:50:32,270 - __main__ - DEBUG - Imported AuthManager
2025-02-04 20:50:32,270 - __main__ - DEBUG - Imported TemplateManager
2025-02-04 20:50:32,270 - __main__ - DEBUG - Imported WorkflowManager
2025-02-04 20:50:32,270 - __main__ - DEBUG - Imported MetricsManager
2025-02-04 20:50:32,270 - __main__ - DEBUG - Initializing AuthManager...
2025-02-04 20:50:32,271 - invoice_agent.security.auth - INFO - AuthManager initialized with redirect URI: http://localhost:8503
2025-02-04 20:50:32,271 - invoice_agent.security.auth - INFO - Using Streamlit port: 8503
2025-02-04 20:50:32,271 - invoice_agent.security.auth - DEBUG - Google Client ID configured: True
2025-02-04 20:50:32,272 - invoice_agent.security.auth - DEBUG - Google Client Secret configured: True
2025-02-04 20:50:32,272 - __main__ - DEBUG - AuthManager initialized successfully
2025-02-04 20:50:32,272 - __main__ - DEBUG - Initializing MetricsManager...
2025-02-04 20:50:32,272 - __main__ - DEBUG - MetricsManager initialized successfully
2025-02-04 20:50:32,272 - __main__ - DEBUG - Initializing InvoiceAgent...
2025-02-04 20:50:32,338 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-02-04 20:50:32,398 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-02-04 20:50:32,542 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/processor_config.json HTTP/1.1" 404 0
2025-02-04 20:50:32,597 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/chat_template.json HTTP/1.1" 404 0
2025-02-04 20:50:32,667 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-02-04 20:50:32,890 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/config.json HTTP/1.1" 200 0
2025-02-04 20:50:32,950 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/config.json HTTP/1.1" 200 0
2025-02-04 20:50:32,987 - __main__ - DEBUG - InvoiceAgent initialized successfully
2025-02-04 20:50:32,987 - __main__ - DEBUG - Initializing WorkflowManager...
2025-02-04 20:50:32,988 - __main__ - DEBUG - WorkflowManager initialized successfully
2025-02-04 20:50:32,988 - __main__ - DEBUG - Initializing TemplateManager...
2025-02-04 20:50:32,988 - __main__ - DEBUG - TemplateManager initialized successfully
2025-02-04 20:50:32,988 - __main__ - DEBUG - Server settings configured
2025-02-04 20:50:32,988 - __main__ - DEBUG - Starting main application
2025-02-04 20:50:32,988 - __main__ - DEBUG - Initial session state: {'page': 'Dashboard', 'auth_flow_started': False, 'initialized': True, 'last_activity': 1738720230.208431, 'auth_error': None, 'authenticated': False, 'user_info': None, 'google_signin': True, 'connection_attempts': 0}
2025-02-04 20:50:32,989 - __main__ - DEBUG - Session state after initialization: {'page': 'Dashboard', 'auth_flow_started': False, 'initialized': True, 'last_activity': 1738720232.988999, 'auth_error': None, 'authenticated': False, 'user_info': None, 'google_signin': True, 'connection_attempts': 0}
2025-02-04 20:50:32,989 - __main__ - DEBUG - Checking for OAuth callback parameters
2025-02-04 20:50:32,989 - __main__ - DEBUG - Query parameters: {}
2025-02-04 20:50:32,989 - __main__ - DEBUG - User not authenticated, showing auth page
2025-02-04 20:50:32,989 - __main__ - DEBUG - Rendering authentication page
2025-02-04 20:50:32,989 - __main__ - DEBUG - Current session state: {'page': 'Dashboard', 'auth_flow_started': False, 'initialized': True, 'last_activity': 1738720232.988999, 'auth_error': None, 'authenticated': False, 'user_info': None, 'google_signin': True, 'connection_attempts': 0}
2025-02-04 20:50:32,990 - __main__ - DEBUG - Showing Google sign-in button
2025-02-04 20:50:32,991 - __main__ - INFO - Google sign-in button clicked
2025-02-04 20:50:32,991 - __main__ - DEBUG - Starting Google OAuth authentication flow
2025-02-04 20:50:32,991 - __main__ - DEBUG - Received query parameters: {}
2025-02-04 20:50:32,991 - __main__ - DEBUG - Auth code present: False
2025-02-04 20:50:32,991 - __main__ - DEBUG - State present: False
2025-02-04 20:50:32,991 - __main__ - DEBUG - Current session state: {'page': 'Dashboard', 'auth_flow_started': False, 'initialized': True, 'last_activity': 1738720232.988999, 'auth_error': None, 'authenticated': False, 'user_info': None, 'google_signin': True, 'connection_attempts': 0}
2025-02-04 20:50:32,991 - __main__ - INFO - Initiating Google OAuth flow...
2025-02-04 20:50:32,991 - invoice_agent.security.auth - DEBUG - Generated new state token: bomlX3LJRQ...
2025-02-04 20:50:32,991 - invoice_agent.security.auth - DEBUG - Using redirect URI: http://localhost:8503
2025-02-04 20:50:32,991 - invoice_agent.security.auth - INFO - Generated auth URL with state token: bomlX3LJRQ...
2025-02-04 20:50:32,991 - invoice_agent.security.auth - DEBUG - Full auth URL: https://accounts.google.com/o/oauth2/v2/auth?client_id=183173833346-kmsle3f3phtd3f71jms96q3uvcoqv0vu.apps.googleusercontent.com&redirect_uri=http%3A%2F%2Flocalhost%3A8503&response_type=code&scope=openid+email+profile&access_type=offline&state=bomlX3LJRQnVo0KzBHf9GE2KYa_d36hPEF954lIKIFU&prompt=consent&include_granted_scopes=true
2025-02-04 20:50:32,991 - __main__ - DEBUG - Generated auth URL: https://accounts.google.com/o/oauth2/v2/auth?client_id=183173833346-kmsle3f3phtd3f71jms96q3uvcoqv0vu.apps.googleusercontent.com&redirect_uri=http%3A%2F%2Flocalhost%3A8503&response_type=code&scope=openid+email+profile&access_type=offline&state=bomlX3LJRQnVo0KzBHf9GE2KYa_d36hPEF954lIKIFU&prompt=consent&include_granted_scopes=true
2025-02-04 20:50:32,992 - __main__ - DEBUG - Auth flow started flag set to True
2025-02-04 20:50:32,992 - __main__ - DEBUG - Session state before redirect: {'page': 'Dashboard', 'auth_flow_started': True, 'initialized': True, 'last_activity': 1738720232.988999, 'auth_error': None, 'authenticated': False, 'user_info': None, 'google_signin': True, 'connection_attempts': 0}
2025-02-04 20:50:32,992 - __main__ - INFO - Redirecting to Google OAuth consent screen...
2025-02-04 20:51:37,354 - __main__ - DEBUG - Python version: 3.12.5 (v3.12.5:ff3bc82f7c9, Aug  7 2024, 05:32:06) [Clang 13.0.0 (clang-1300.0.29.30)]
2025-02-04 20:51:37,355 - __main__ - DEBUG - Python executable: /Users/sailesh/Documents/GitHub/aiagent/venv/bin/python3.12
2025-02-04 20:51:37,355 - __main__ - DEBUG - Current working directory: /Users/sailesh/Documents/GitHub/invoiceAgent
2025-02-04 20:51:37,355 - __main__ - DEBUG - PYTHONPATH: :/Users/sailesh/Documents/GitHub/invoiceAgent/src
2025-02-04 20:51:37,355 - __main__ - DEBUG - Sys.path: ['src/invoice_agent/ui/app.py', 'src/invoice_agent/ui', '/Users/sailesh/Documents/GitHub/aiagent/venv/bin', '/Users/sailesh/Documents/GitHub/invoiceAgent', '/Users/sailesh/Documents/GitHub/invoiceAgent/src', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python312.zip', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/lib-dynload', '/Users/sailesh/Documents/GitHub/aiagent/venv/lib/python3.12/site-packages', '/var/folders/0c/vbd1lzvs6p35p66t1zm047sh0000gn/T/tmpnpxo44ed']
2025-02-04 20:51:37,359 - __main__ - DEBUG - Environment variables loaded
2025-02-04 20:51:37,359 - __main__ - DEBUG - Attempting to import invoice_agent modules...
2025-02-04 20:51:37,359 - __main__ - DEBUG - Importing invoice_agent modules...
2025-02-04 20:51:37,359 - __main__ - DEBUG - Imported InvoiceAgent
2025-02-04 20:51:37,359 - __main__ - DEBUG - Imported config_loader
2025-02-04 20:51:37,359 - __main__ - DEBUG - Imported AuthManager
2025-02-04 20:51:37,359 - __main__ - DEBUG - Imported TemplateManager
2025-02-04 20:51:37,359 - __main__ - DEBUG - Imported WorkflowManager
2025-02-04 20:51:37,359 - __main__ - DEBUG - Imported MetricsManager
2025-02-04 20:51:37,359 - __main__ - DEBUG - Initializing AuthManager...
2025-02-04 20:51:37,359 - invoice_agent.security.auth - INFO - AuthManager initialized with redirect URI: http://localhost:8503
2025-02-04 20:51:37,359 - invoice_agent.security.auth - INFO - Using Streamlit port: 8503
2025-02-04 20:51:37,359 - invoice_agent.security.auth - DEBUG - Google Client ID configured: True
2025-02-04 20:51:37,359 - invoice_agent.security.auth - DEBUG - Google Client Secret configured: True
2025-02-04 20:51:37,360 - __main__ - DEBUG - AuthManager initialized successfully
2025-02-04 20:51:37,360 - __main__ - DEBUG - Initializing MetricsManager...
2025-02-04 20:51:37,360 - __main__ - DEBUG - MetricsManager initialized successfully
2025-02-04 20:51:37,360 - __main__ - DEBUG - Initializing InvoiceAgent...
2025-02-04 20:51:37,410 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-02-04 20:51:37,461 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-02-04 20:51:37,603 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/processor_config.json HTTP/1.1" 404 0
2025-02-04 20:51:37,659 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/chat_template.json HTTP/1.1" 404 0
2025-02-04 20:51:37,732 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-02-04 20:51:37,903 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/config.json HTTP/1.1" 200 0
2025-02-04 20:51:37,957 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/config.json HTTP/1.1" 200 0
2025-02-04 20:51:37,997 - __main__ - DEBUG - InvoiceAgent initialized successfully
2025-02-04 20:51:37,997 - __main__ - DEBUG - Initializing WorkflowManager...
2025-02-04 20:51:37,999 - __main__ - DEBUG - WorkflowManager initialized successfully
2025-02-04 20:51:37,999 - __main__ - DEBUG - Initializing TemplateManager...
2025-02-04 20:51:37,999 - __main__ - DEBUG - TemplateManager initialized successfully
2025-02-04 20:51:37,999 - __main__ - DEBUG - Server settings configured
2025-02-04 20:51:38,000 - __main__ - DEBUG - Starting main application
2025-02-04 20:51:38,000 - __main__ - DEBUG - Initial session state: {}
2025-02-04 20:51:38,000 - __main__ - DEBUG - Session state after initialization: {'page': 'Dashboard', 'auth_flow_started': False, 'initialized': True, 'last_activity': 1738720298.0008729, 'auth_error': None, 'authenticated': False, 'user_info': None, 'connection_attempts': 0}
2025-02-04 20:51:38,001 - __main__ - DEBUG - Checking for OAuth callback parameters
2025-02-04 20:51:38,001 - __main__ - DEBUG - Query parameters: {}
2025-02-04 20:51:38,001 - __main__ - DEBUG - User not authenticated, showing auth page
2025-02-04 20:51:38,001 - __main__ - DEBUG - Rendering authentication page
2025-02-04 20:51:38,001 - __main__ - DEBUG - Current session state: {'page': 'Dashboard', 'auth_flow_started': False, 'initialized': True, 'last_activity': 1738720298.0008729, 'auth_error': None, 'authenticated': False, 'user_info': None, 'connection_attempts': 0}
2025-02-04 20:51:38,002 - __main__ - DEBUG - Showing Google sign-in button
2025-02-04 20:51:38,003 - __main__ - DEBUG - Showing Microsoft sign-in button
2025-02-04 20:51:38,003 - __main__ - DEBUG - Showing Service Account sign-in form
2025-02-04 20:51:39,336 - __main__ - DEBUG - Python version: 3.12.5 (v3.12.5:ff3bc82f7c9, Aug  7 2024, 05:32:06) [Clang 13.0.0 (clang-1300.0.29.30)]
2025-02-04 20:51:39,337 - __main__ - DEBUG - Python executable: /Users/sailesh/Documents/GitHub/aiagent/venv/bin/python3.12
2025-02-04 20:51:39,337 - __main__ - DEBUG - Current working directory: /Users/sailesh/Documents/GitHub/invoiceAgent
2025-02-04 20:51:39,337 - __main__ - DEBUG - PYTHONPATH: :/Users/sailesh/Documents/GitHub/invoiceAgent/src
2025-02-04 20:51:39,337 - __main__ - DEBUG - Sys.path: ['src/invoice_agent/ui/app.py', 'src/invoice_agent/ui', '/Users/sailesh/Documents/GitHub/aiagent/venv/bin', '/Users/sailesh/Documents/GitHub/invoiceAgent', '/Users/sailesh/Documents/GitHub/invoiceAgent/src', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python312.zip', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12', '/Library/Frameworks/Python.framework/Versions/3.12/lib/python3.12/lib-dynload', '/Users/sailesh/Documents/GitHub/aiagent/venv/lib/python3.12/site-packages', '/var/folders/0c/vbd1lzvs6p35p66t1zm047sh0000gn/T/tmpnpxo44ed']
2025-02-04 20:51:39,339 - __main__ - DEBUG - Environment variables loaded
2025-02-04 20:51:39,340 - __main__ - DEBUG - Attempting to import invoice_agent modules...
2025-02-04 20:51:39,340 - __main__ - DEBUG - Importing invoice_agent modules...
2025-02-04 20:51:39,340 - __main__ - DEBUG - Imported InvoiceAgent
2025-02-04 20:51:39,341 - __main__ - DEBUG - Imported config_loader
2025-02-04 20:51:39,341 - __main__ - DEBUG - Imported AuthManager
2025-02-04 20:51:39,341 - __main__ - DEBUG - Imported TemplateManager
2025-02-04 20:51:39,341 - __main__ - DEBUG - Imported WorkflowManager
2025-02-04 20:51:39,341 - __main__ - DEBUG - Imported MetricsManager
2025-02-04 20:51:39,341 - __main__ - DEBUG - Initializing AuthManager...
2025-02-04 20:51:39,341 - invoice_agent.security.auth - INFO - AuthManager initialized with redirect URI: http://localhost:8503
2025-02-04 20:51:39,341 - invoice_agent.security.auth - INFO - Using Streamlit port: 8503
2025-02-04 20:51:39,341 - invoice_agent.security.auth - DEBUG - Google Client ID configured: True
2025-02-04 20:51:39,341 - invoice_agent.security.auth - DEBUG - Google Client Secret configured: True
2025-02-04 20:51:39,342 - __main__ - DEBUG - AuthManager initialized successfully
2025-02-04 20:51:39,342 - __main__ - DEBUG - Initializing MetricsManager...
2025-02-04 20:51:39,344 - __main__ - DEBUG - MetricsManager initialized successfully
2025-02-04 20:51:39,344 - __main__ - DEBUG - Initializing InvoiceAgent...
2025-02-04 20:51:39,395 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-02-04 20:51:39,449 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-02-04 20:51:40,232 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/processor_config.json HTTP/1.1" 404 0
2025-02-04 20:51:40,290 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/chat_template.json HTTP/1.1" 404 0
2025-02-04 20:51:40,349 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-02-04 20:51:40,512 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/config.json HTTP/1.1" 200 0
2025-02-04 20:51:40,564 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/config.json HTTP/1.1" 200 0
2025-02-04 20:51:40,601 - __main__ - DEBUG - InvoiceAgent initialized successfully
2025-02-04 20:51:40,601 - __main__ - DEBUG - Initializing WorkflowManager...
2025-02-04 20:51:40,601 - __main__ - DEBUG - WorkflowManager initialized successfully
2025-02-04 20:51:40,601 - __main__ - DEBUG - Initializing TemplateManager...
2025-02-04 20:51:40,601 - __main__ - DEBUG - TemplateManager initialized successfully
2025-02-04 20:51:40,601 - __main__ - DEBUG - Server settings configured
2025-02-04 20:51:40,602 - __main__ - DEBUG - Starting main application
2025-02-04 20:51:40,602 - __main__ - DEBUG - Initial session state: {'page': 'Dashboard', 'auth_flow_started': False, 'initialized': True, 'last_activity': 1738720298.0008729, 'auth_error': None, 'authenticated': False, 'user_info': None, 'google_signin': True, 'connection_attempts': 0}
2025-02-04 20:51:40,602 - __main__ - DEBUG - Session state after initialization: {'page': 'Dashboard', 'auth_flow_started': False, 'initialized': True, 'last_activity': 1738720300.602468, 'auth_error': None, 'authenticated': False, 'user_info': None, 'google_signin': True, 'connection_attempts': 0}
2025-02-04 20:51:40,602 - __main__ - DEBUG - Checking for OAuth callback parameters
2025-02-04 20:51:40,602 - __main__ - DEBUG - Query parameters: {}
2025-02-04 20:51:40,602 - __main__ - DEBUG - User not authenticated, showing auth page
2025-02-04 20:51:40,602 - __main__ - DEBUG - Rendering authentication page
2025-02-04 20:51:40,603 - __main__ - DEBUG - Current session state: {'page': 'Dashboard', 'auth_flow_started': False, 'initialized': True, 'last_activity': 1738720300.602468, 'auth_error': None, 'authenticated': False, 'user_info': None, 'google_signin': True, 'connection_attempts': 0}
2025-02-04 20:51:40,603 - __main__ - DEBUG - Showing Google sign-in button
2025-02-04 20:51:40,604 - __main__ - INFO - Google sign-in button clicked
2025-02-04 20:51:40,604 - __main__ - DEBUG - Starting Google OAuth authentication flow
2025-02-04 20:51:40,604 - __main__ - DEBUG - Received query parameters: {}
2025-02-04 20:51:40,604 - __main__ - DEBUG - Auth code present: False
2025-02-04 20:51:40,604 - __main__ - DEBUG - State present: False
2025-02-04 20:51:40,604 - __main__ - DEBUG - Current session state: {'page': 'Dashboard', 'auth_flow_started': False, 'initialized': True, 'last_activity': 1738720300.602468, 'auth_error': None, 'authenticated': False, 'user_info': None, 'google_signin': True, 'connection_attempts': 0}
2025-02-04 20:51:40,604 - __main__ - INFO - Initiating Google OAuth flow...
2025-02-04 20:51:40,604 - invoice_agent.security.auth - DEBUG - Generated new state token: C4XJeWF-24...
2025-02-04 20:51:40,604 - invoice_agent.security.auth - DEBUG - Using redirect URI: http://localhost:8503
2025-02-04 20:51:40,604 - invoice_agent.security.auth - INFO - Generated auth URL with state token: C4XJeWF-24...
2025-02-04 20:51:40,604 - invoice_agent.security.auth - DEBUG - Full auth URL: https://accounts.google.com/o/oauth2/v2/auth?client_id=183173833346-kmsle3f3phtd3f71jms96q3uvcoqv0vu.apps.googleusercontent.com&redirect_uri=http%3A%2F%2Flocalhost%3A8503&response_type=code&scope=openid+email+profile&access_type=offline&state=C4XJeWF-24w9cD0E_4l8lk7Hs7HEBiGPE78_0QMu-ps&prompt=consent&include_granted_scopes=true
2025-02-04 20:51:40,604 - __main__ - DEBUG - Generated auth URL: https://accounts.google.com/o/oauth2/v2/auth?client_id=183173833346-kmsle3f3phtd3f71jms96q3uvcoqv0vu.apps.googleusercontent.com&redirect_uri=http%3A%2F%2Flocalhost%3A8503&response_type=code&scope=openid+email+profile&access_type=offline&state=C4XJeWF-24w9cD0E_4l8lk7Hs7HEBiGPE78_0QMu-ps&prompt=consent&include_granted_scopes=true
2025-02-04 20:51:40,604 - __main__ - DEBUG - Auth flow started flag set to True
2025-02-04 20:51:40,604 - __main__ - DEBUG - Session state before redirect: {'page': 'Dashboard', 'auth_flow_started': True, 'initialized': True, 'last_activity': 1738720300.602468, 'auth_error': None, 'authenticated': False, 'user_info': None, 'google_signin': True, 'connection_attempts': 0}
2025-02-04 20:51:40,604 - __main__ - INFO - Redirecting to Google OAuth consent screen...
2025-02-04 20:52:34,564 - invoice_agent.security.auth - INFO - AuthManager initialized with redirect URI: http://localhost:8502
2025-02-04 20:52:34,564 - invoice_agent.security.auth - INFO - Using Streamlit port: 8502
2025-02-04 20:52:34,565 - invoice_agent.security.auth - DEBUG - Google Client ID configured: True
2025-02-04 20:52:34,565 - invoice_agent.security.auth - DEBUG - Google Client Secret configured: True
2025-02-04 20:52:34,578 - invoice_agent.security.auth - INFO - AuthManager initialized with redirect URI: http://localhost:8502
2025-02-04 20:52:34,578 - invoice_agent.security.auth - INFO - Using Streamlit port: 8502
2025-02-04 20:52:34,579 - invoice_agent.security.auth - DEBUG - Google Client ID configured: True
2025-02-04 20:52:34,579 - invoice_agent.security.auth - DEBUG - Google Client Secret configured: True
2025-02-04 20:52:34,650 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-02-04 20:52:34,710 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-02-04 20:52:34,871 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/processor_config.json HTTP/1.1" 404 0
2025-02-04 20:52:34,945 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/chat_template.json HTTP/1.1" 404 0
2025-02-04 20:52:35,004 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-02-04 20:52:35,165 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/config.json HTTP/1.1" 200 0
2025-02-04 20:52:35,262 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/config.json HTTP/1.1" 200 0
2025-02-04 20:53:57,179 - invoice_agent.security.auth - INFO - AuthManager initialized with redirect URI: http://localhost:8502
2025-02-04 20:53:57,179 - invoice_agent.security.auth - INFO - Using Streamlit port: 8502
2025-02-04 20:53:57,179 - invoice_agent.security.auth - DEBUG - Google Client ID configured: True
2025-02-04 20:53:57,179 - invoice_agent.security.auth - DEBUG - Google Client Secret configured: True
2025-02-04 20:53:57,192 - invoice_agent.security.auth - INFO - AuthManager initialized with redirect URI: http://localhost:8502
2025-02-04 20:53:57,193 - invoice_agent.security.auth - INFO - Using Streamlit port: 8502
2025-02-04 20:53:57,194 - invoice_agent.security.auth - DEBUG - Google Client ID configured: True
2025-02-04 20:53:57,194 - invoice_agent.security.auth - DEBUG - Google Client Secret configured: True
2025-02-04 20:53:57,246 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-02-04 20:53:57,305 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-02-04 20:53:57,487 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/processor_config.json HTTP/1.1" 404 0
2025-02-04 20:53:57,587 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/chat_template.json HTTP/1.1" 404 0
2025-02-04 20:53:57,649 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-02-04 20:53:57,807 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/config.json HTTP/1.1" 200 0
2025-02-04 20:53:57,915 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/config.json HTTP/1.1" 200 0
2025-02-04 20:54:06,717 - invoice_agent.security.auth - INFO - AuthManager initialized with redirect URI: http://localhost:8502
2025-02-04 20:54:06,717 - invoice_agent.security.auth - INFO - Using Streamlit port: 8502
2025-02-04 20:54:06,719 - invoice_agent.security.auth - DEBUG - Google Client ID configured: True
2025-02-04 20:54:06,720 - invoice_agent.security.auth - DEBUG - Google Client Secret configured: True
2025-02-04 20:54:06,804 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/preprocessor_config.json HTTP/1.1" 200 0
2025-02-04 20:54:06,859 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/tokenizer_config.json HTTP/1.1" 200 0
2025-02-04 20:54:07,025 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/processor_config.json HTTP/1.1" 404 0
2025-02-04 20:54:07,087 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/chat_template.json HTTP/1.1" 404 0
2025-02-04 20:54:07,191 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/chat_template.jinja HTTP/1.1" 404 0
2025-02-04 20:54:07,449 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/config.json HTTP/1.1" 200 0
2025-02-04 20:54:07,507 - urllib3.connectionpool - DEBUG - https://huggingface.co:443 "HEAD /microsoft/layoutlmv3-base/resolve/main/config.json HTTP/1.1" 200 0
